INFO:     172.31.128.11:51172 - "POST /init-db/?force=true HTTP/1.1" 200 OK
{"timestamp": "2025-02-11T22:21:12.544326", "level": "INFO", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "method": "POST", "url": "http://6ed7ce35-85b3-498b-9e9b-4d63631ed8e3-00-2owzgyvztotfg.worf.replit.dev/time-entries/upload/", "client_host": "172.31.128.11", "headers": {"host": "6ed7ce35-85b3-498b-9e9b-4d63631ed8e3-00-2owzgyvztotfg.worf.replit.dev", "user-agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/132.0.0.0 Safari/537.36 Edg/132.0.0.0", "content-length": "49074", "accept": "application/json", "accept-encoding": "gzip, deflate, br, zstd", "accept-language": "en-US,en;q=0.9", "content-type": "multipart/form-data; boundary=----WebKitFormBoundary7tyy5uWJkBvgIOO5", "origin": "https://6ed7ce35-85b3-498b-9e9b-4d63631ed8e3-00-2owzgyvztotfg.worf.replit.dev:8080", "referer": "https://6ed7ce35-85b3-498b-9e9b-4d63631ed8e3-00-2owzgyvztotfg.worf.replit.dev:8080/docs", "sec-ch-ua": "\"Not A(Brand\";v=\"8\", \"Chromium\";v=\"132\", \"Microsoft Edge\";v=\"132\"", "sec-ch-ua-mobile": "?0", "sec-ch-ua-platform": "\"Windows\"", "sec-fetch-dest": "empty", "sec-fetch-mode": "cors", "sec-fetch-site": "same-origin", "x-forwarded-for": "67.11.111.13, 165.225.36.171, 10.83.7.121", "x-forwarded-proto": "https", "x-replit-user-bio": "", "x-replit-user-id": "", "x-replit-user-name": "", "x-replit-user-profile-image": "", "x-replit-user-roles": "", "x-replit-user-teams": "", "x-replit-user-url": ""}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload/"}}
{"timestamp": "2025-02-11T22:21:12.590934", "level": "DEBUG", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "Database session created", "context": {}}
{"timestamp": "2025-02-11T22:21:12.591580", "level": "INFO", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "Processing timesheet upload: Hours Tracker.xlsx", "context": {}}
{"timestamp": "2025-02-11T22:21:12.591910", "level": "DEBUG", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "ProjectRepository initialized", "context": {}}
{"timestamp": "2025-02-11T22:21:12.592202", "level": "DEBUG", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "TimesheetService initialized", "context": {}}
{"timestamp": "2025-02-11T22:21:12.592413", "level": "INFO", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "Processing timesheet upload: Hours Tracker.xlsx", "context": {}}
{"timestamp": "2025-02-11T22:21:12.592662", "level": "DEBUG", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "Starting Excel file analysis", "context": {}}
/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/openpyxl/worksheet/_reader.py:329: UserWarning: Data Validation extension is not supported and will be removed
  warn(msg)
{"timestamp": "2025-02-11T22:21:12.876449", "level": "INFO", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "Successfully parsed 216 records from Excel file", "context": {}}
{"timestamp": "2025-02-11T22:21:13.278219", "level": "ERROR", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "Error in bulk create: (psycopg2.errors.ForeignKeyViolation) insert or update on table \"time_entries\" violates foreign key constraint \"time_entries_project_fkey\"\nDETAIL:  Key (project)=(Wichita, KS) is not present in table \"projects\".\n\n[SQL: INSERT INTO time_entries (week_number, month, category, subcategory, customer, project, task_description, hours, date, created_at, updated_at) SELECT p0::INTEGER, p1::VARCHAR, p2::VARCHAR, p3::VARCHAR, p4::VARCHAR, p5::VARCHAR, p6::VARCHAR, p7::FLOAT ... 46974 characters truncated ... , p8, p9, p10, sen_counter) ORDER BY sen_counter RETURNING time_entries.id, time_entries.id AS id__1]\n[parameters: {'category__0': 'Other', 'updated_at__0': None, 'subcategory__0': 'Other Training', 'date__0': datetime.date(2024, 10, 7), 'project__0': 'Unassigned', 'week_number__0': 41, 'task_description__0': 'New hire orientation', 'created_at__0': datetime.datetime(2025, 2, 11, 22, 21, 12, 881920), 'hours__0': 6.0, 'customer__0': 'Unassigned', 'month__0': 'October', 'category__1': 'Other', 'updated_at__1': None, 'subcategory__1': 'Other Training', 'date__1': datetime.date(2024, 10, 7), 'project__1': 'Unassigned', 'week_number__1': 41, 'task_description__1': 'Andrew<>Joseph ', 'created_at__1': datetime.datetime(2025, 2, 11, 22, 21, 12, 883099), 'hours__1': 2.0, 'customer__1': 'Unassigned', 'month__1': 'October', 'category__2': 'Other', 'updated_at__2': None, 'subcategory__2': 'Other Training', 'date__2': datetime.date(2024, 10, 8), 'project__2': 'Unassigned', 'week_number__2': 41, 'task_description__2': 'Andrew<>Joseph ', 'created_at__2': datetime.datetime(2025, 2, 11, 22, 21, 12, 884283), 'hours__2': 2.0, 'customer__2': 'Unassigned', 'month__2': 'October', 'category__3': 'Other', 'updated_at__3': None, 'subcategory__3': 'Info/File Management', 'date__3': datetime.date(2024, 10, 8), 'project__3': 'Unassigned', 'week_number__3': 41, 'task_description__3': 'I-9 Meeting', 'created_at__3': datetime.datetime(2025, 2, 11, 22, 21, 12, 885572), 'hours__3': 1.0, 'customer__3': 'Unassigned', 'month__3': 'October', 'category__4': 'Other', 'updated_at__4': None, 'subcategory__4': 'Safety Training/Reporting', 'date__4': datetime.date(2024, 10, 8), 'project__4': 'Unassigned', 'week_number__4': 41 ... 2276 parameters truncated ... 'week_number__211': 52, 'task_description__211': 'Christmas Day', 'created_at__211': datetime.datetime(2025, 2, 11, 22, 21, 13, 140568), 'hours__211': 8.0, 'customer__211': 'Unassigned', 'month__211': 'December', 'category__212': 'Other', 'updated_at__212': None, 'subcategory__212': 'Info/File Management', 'date__212': datetime.date(2024, 12, 26), 'project__212': 'Unassigned', 'week_number__212': 52, 'task_description__212': 'Compiling report for Hiland', 'created_at__212': datetime.datetime(2025, 2, 11, 22, 21, 13, 141682), 'hours__212': 8.0, 'customer__212': 'Unassigned', 'month__212': 'December', 'category__213': 'Other', 'updated_at__213': None, 'subcategory__213': 'Info/File Management', 'date__213': datetime.date(2024, 12, 27), 'project__213': 'Unassigned', 'week_number__213': 52, 'task_description__213': 'Compiling report for Hiland', 'created_at__213': datetime.datetime(2025, 2, 11, 22, 21, 13, 142809), 'hours__213': 8.0, 'customer__213': 'Unassigned', 'month__213': 'December', 'category__214': 'Other', 'updated_at__214': None, 'subcategory__214': 'Info/File Management', 'date__214': datetime.date(2024, 12, 30), 'project__214': 'Unassigned', 'week_number__214': 1, 'task_description__214': 'Compiling report for Hiland', 'created_at__214': datetime.datetime(2025, 2, 11, 22, 21, 13, 143930), 'hours__214': 8.0, 'customer__214': 'Unassigned', 'month__214': 'December', 'category__215': 'Other', 'updated_at__215': None, 'subcategory__215': 'Holidays', 'date__215': datetime.date(2024, 12, 31), 'project__215': 'Unassigned', 'week_number__215': 1, 'task_description__215': 'NYE', 'created_at__215': datetime.datetime(2025, 2, 11, 22, 21, 13, 145037), 'hours__215': 8.0, 'customer__215': 'Unassigned', 'month__215': 'December'}]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "context": {}}
{"timestamp": "2025-02-11T22:21:13.279048", "level": "ERROR", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "Error importing Excel data: (psycopg2.errors.ForeignKeyViolation) insert or update on table \"time_entries\" violates foreign key constraint \"time_entries_project_fkey\"\nDETAIL:  Key (project)=(Wichita, KS) is not present in table \"projects\".\n\n[SQL: INSERT INTO time_entries (week_number, month, category, subcategory, customer, project, task_description, hours, date, created_at, updated_at) SELECT p0::INTEGER, p1::VARCHAR, p2::VARCHAR, p3::VARCHAR, p4::VARCHAR, p5::VARCHAR, p6::VARCHAR, p7::FLOAT ... 46974 characters truncated ... , p8, p9, p10, sen_counter) ORDER BY sen_counter RETURNING time_entries.id, time_entries.id AS id__1]\n[parameters: {'category__0': 'Other', 'updated_at__0': None, 'subcategory__0': 'Other Training', 'date__0': datetime.date(2024, 10, 7), 'project__0': 'Unassigned', 'week_number__0': 41, 'task_description__0': 'New hire orientation', 'created_at__0': datetime.datetime(2025, 2, 11, 22, 21, 12, 881920), 'hours__0': 6.0, 'customer__0': 'Unassigned', 'month__0': 'October', 'category__1': 'Other', 'updated_at__1': None, 'subcategory__1': 'Other Training', 'date__1': datetime.date(2024, 10, 7), 'project__1': 'Unassigned', 'week_number__1': 41, 'task_description__1': 'Andrew<>Joseph ', 'created_at__1': datetime.datetime(2025, 2, 11, 22, 21, 12, 883099), 'hours__1': 2.0, 'customer__1': 'Unassigned', 'month__1': 'October', 'category__2': 'Other', 'updated_at__2': None, 'subcategory__2': 'Other Training', 'date__2': datetime.date(2024, 10, 8), 'project__2': 'Unassigned', 'week_number__2': 41, 'task_description__2': 'Andrew<>Joseph ', 'created_at__2': datetime.datetime(2025, 2, 11, 22, 21, 12, 884283), 'hours__2': 2.0, 'customer__2': 'Unassigned', 'month__2': 'October', 'category__3': 'Other', 'updated_at__3': None, 'subcategory__3': 'Info/File Management', 'date__3': datetime.date(2024, 10, 8), 'project__3': 'Unassigned', 'week_number__3': 41, 'task_description__3': 'I-9 Meeting', 'created_at__3': datetime.datetime(2025, 2, 11, 22, 21, 12, 885572), 'hours__3': 1.0, 'customer__3': 'Unassigned', 'month__3': 'October', 'category__4': 'Other', 'updated_at__4': None, 'subcategory__4': 'Safety Training/Reporting', 'date__4': datetime.date(2024, 10, 8), 'project__4': 'Unassigned', 'week_number__4': 41 ... 2276 parameters truncated ... 'week_number__211': 52, 'task_description__211': 'Christmas Day', 'created_at__211': datetime.datetime(2025, 2, 11, 22, 21, 13, 140568), 'hours__211': 8.0, 'customer__211': 'Unassigned', 'month__211': 'December', 'category__212': 'Other', 'updated_at__212': None, 'subcategory__212': 'Info/File Management', 'date__212': datetime.date(2024, 12, 26), 'project__212': 'Unassigned', 'week_number__212': 52, 'task_description__212': 'Compiling report for Hiland', 'created_at__212': datetime.datetime(2025, 2, 11, 22, 21, 13, 141682), 'hours__212': 8.0, 'customer__212': 'Unassigned', 'month__212': 'December', 'category__213': 'Other', 'updated_at__213': None, 'subcategory__213': 'Info/File Management', 'date__213': datetime.date(2024, 12, 27), 'project__213': 'Unassigned', 'week_number__213': 52, 'task_description__213': 'Compiling report for Hiland', 'created_at__213': datetime.datetime(2025, 2, 11, 22, 21, 13, 142809), 'hours__213': 8.0, 'customer__213': 'Unassigned', 'month__213': 'December', 'category__214': 'Other', 'updated_at__214': None, 'subcategory__214': 'Info/File Management', 'date__214': datetime.date(2024, 12, 30), 'project__214': 'Unassigned', 'week_number__214': 1, 'task_description__214': 'Compiling report for Hiland', 'created_at__214': datetime.datetime(2025, 2, 11, 22, 21, 13, 143930), 'hours__214': 8.0, 'customer__214': 'Unassigned', 'month__214': 'December', 'category__215': 'Other', 'updated_at__215': None, 'subcategory__215': 'Holidays', 'date__215': datetime.date(2024, 12, 31), 'project__215': 'Unassigned', 'week_number__215': 1, 'task_description__215': 'NYE', 'created_at__215': datetime.datetime(2025, 2, 11, 22, 21, 13, 145037), 'hours__215': 8.0, 'customer__215': 'Unassigned', 'month__215': 'December'}]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "context": {}}
{"timestamp": "2025-02-11T22:21:13.279723", "level": "ERROR", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "Error processing timesheet: (psycopg2.errors.ForeignKeyViolation) insert or update on table \"time_entries\" violates foreign key constraint \"time_entries_project_fkey\"\nDETAIL:  Key (project)=(Wichita, KS) is not present in table \"projects\".\n\n[SQL: INSERT INTO time_entries (week_number, month, category, subcategory, customer, project, task_description, hours, date, created_at, updated_at) SELECT p0::INTEGER, p1::VARCHAR, p2::VARCHAR, p3::VARCHAR, p4::VARCHAR, p5::VARCHAR, p6::VARCHAR, p7::FLOAT ... 46974 characters truncated ... , p8, p9, p10, sen_counter) ORDER BY sen_counter RETURNING time_entries.id, time_entries.id AS id__1]\n[parameters: {'category__0': 'Other', 'updated_at__0': None, 'subcategory__0': 'Other Training', 'date__0': datetime.date(2024, 10, 7), 'project__0': 'Unassigned', 'week_number__0': 41, 'task_description__0': 'New hire orientation', 'created_at__0': datetime.datetime(2025, 2, 11, 22, 21, 12, 881920), 'hours__0': 6.0, 'customer__0': 'Unassigned', 'month__0': 'October', 'category__1': 'Other', 'updated_at__1': None, 'subcategory__1': 'Other Training', 'date__1': datetime.date(2024, 10, 7), 'project__1': 'Unassigned', 'week_number__1': 41, 'task_description__1': 'Andrew<>Joseph ', 'created_at__1': datetime.datetime(2025, 2, 11, 22, 21, 12, 883099), 'hours__1': 2.0, 'customer__1': 'Unassigned', 'month__1': 'October', 'category__2': 'Other', 'updated_at__2': None, 'subcategory__2': 'Other Training', 'date__2': datetime.date(2024, 10, 8), 'project__2': 'Unassigned', 'week_number__2': 41, 'task_description__2': 'Andrew<>Joseph ', 'created_at__2': datetime.datetime(2025, 2, 11, 22, 21, 12, 884283), 'hours__2': 2.0, 'customer__2': 'Unassigned', 'month__2': 'October', 'category__3': 'Other', 'updated_at__3': None, 'subcategory__3': 'Info/File Management', 'date__3': datetime.date(2024, 10, 8), 'project__3': 'Unassigned', 'week_number__3': 41, 'task_description__3': 'I-9 Meeting', 'created_at__3': datetime.datetime(2025, 2, 11, 22, 21, 12, 885572), 'hours__3': 1.0, 'customer__3': 'Unassigned', 'month__3': 'October', 'category__4': 'Other', 'updated_at__4': None, 'subcategory__4': 'Safety Training/Reporting', 'date__4': datetime.date(2024, 10, 8), 'project__4': 'Unassigned', 'week_number__4': 41 ... 2276 parameters truncated ... 'week_number__211': 52, 'task_description__211': 'Christmas Day', 'created_at__211': datetime.datetime(2025, 2, 11, 22, 21, 13, 140568), 'hours__211': 8.0, 'customer__211': 'Unassigned', 'month__211': 'December', 'category__212': 'Other', 'updated_at__212': None, 'subcategory__212': 'Info/File Management', 'date__212': datetime.date(2024, 12, 26), 'project__212': 'Unassigned', 'week_number__212': 52, 'task_description__212': 'Compiling report for Hiland', 'created_at__212': datetime.datetime(2025, 2, 11, 22, 21, 13, 141682), 'hours__212': 8.0, 'customer__212': 'Unassigned', 'month__212': 'December', 'category__213': 'Other', 'updated_at__213': None, 'subcategory__213': 'Info/File Management', 'date__213': datetime.date(2024, 12, 27), 'project__213': 'Unassigned', 'week_number__213': 52, 'task_description__213': 'Compiling report for Hiland', 'created_at__213': datetime.datetime(2025, 2, 11, 22, 21, 13, 142809), 'hours__213': 8.0, 'customer__213': 'Unassigned', 'month__213': 'December', 'category__214': 'Other', 'updated_at__214': None, 'subcategory__214': 'Info/File Management', 'date__214': datetime.date(2024, 12, 30), 'project__214': 'Unassigned', 'week_number__214': 1, 'task_description__214': 'Compiling report for Hiland', 'created_at__214': datetime.datetime(2025, 2, 11, 22, 21, 13, 143930), 'hours__214': 8.0, 'customer__214': 'Unassigned', 'month__214': 'December', 'category__215': 'Other', 'updated_at__215': None, 'subcategory__215': 'Holidays', 'date__215': datetime.date(2024, 12, 31), 'project__215': 'Unassigned', 'week_number__215': 1, 'task_description__215': 'NYE', 'created_at__215': datetime.datetime(2025, 2, 11, 22, 21, 13, 145037), 'hours__215': 8.0, 'customer__215': 'Unassigned', 'month__215': 'December'}]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "context": {}}
{"timestamp": "2025-02-11T22:21:13.280306", "level": "ERROR", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "Error processing timesheet: 400: (psycopg2.errors.ForeignKeyViolation) insert or update on table \"time_entries\" violates foreign key constraint \"time_entries_project_fkey\"\nDETAIL:  Key (project)=(Wichita, KS) is not present in table \"projects\".\n\n[SQL: INSERT INTO time_entries (week_number, month, category, subcategory, customer, project, task_description, hours, date, created_at, updated_at) SELECT p0::INTEGER, p1::VARCHAR, p2::VARCHAR, p3::VARCHAR, p4::VARCHAR, p5::VARCHAR, p6::VARCHAR, p7::FLOAT ... 46974 characters truncated ... , p8, p9, p10, sen_counter) ORDER BY sen_counter RETURNING time_entries.id, time_entries.id AS id__1]\n[parameters: {'category__0': 'Other', 'updated_at__0': None, 'subcategory__0': 'Other Training', 'date__0': datetime.date(2024, 10, 7), 'project__0': 'Unassigned', 'week_number__0': 41, 'task_description__0': 'New hire orientation', 'created_at__0': datetime.datetime(2025, 2, 11, 22, 21, 12, 881920), 'hours__0': 6.0, 'customer__0': 'Unassigned', 'month__0': 'October', 'category__1': 'Other', 'updated_at__1': None, 'subcategory__1': 'Other Training', 'date__1': datetime.date(2024, 10, 7), 'project__1': 'Unassigned', 'week_number__1': 41, 'task_description__1': 'Andrew<>Joseph ', 'created_at__1': datetime.datetime(2025, 2, 11, 22, 21, 12, 883099), 'hours__1': 2.0, 'customer__1': 'Unassigned', 'month__1': 'October', 'category__2': 'Other', 'updated_at__2': None, 'subcategory__2': 'Other Training', 'date__2': datetime.date(2024, 10, 8), 'project__2': 'Unassigned', 'week_number__2': 41, 'task_description__2': 'Andrew<>Joseph ', 'created_at__2': datetime.datetime(2025, 2, 11, 22, 21, 12, 884283), 'hours__2': 2.0, 'customer__2': 'Unassigned', 'month__2': 'October', 'category__3': 'Other', 'updated_at__3': None, 'subcategory__3': 'Info/File Management', 'date__3': datetime.date(2024, 10, 8), 'project__3': 'Unassigned', 'week_number__3': 41, 'task_description__3': 'I-9 Meeting', 'created_at__3': datetime.datetime(2025, 2, 11, 22, 21, 12, 885572), 'hours__3': 1.0, 'customer__3': 'Unassigned', 'month__3': 'October', 'category__4': 'Other', 'updated_at__4': None, 'subcategory__4': 'Safety Training/Reporting', 'date__4': datetime.date(2024, 10, 8), 'project__4': 'Unassigned', 'week_number__4': 41 ... 2276 parameters truncated ... 'week_number__211': 52, 'task_description__211': 'Christmas Day', 'created_at__211': datetime.datetime(2025, 2, 11, 22, 21, 13, 140568), 'hours__211': 8.0, 'customer__211': 'Unassigned', 'month__211': 'December', 'category__212': 'Other', 'updated_at__212': None, 'subcategory__212': 'Info/File Management', 'date__212': datetime.date(2024, 12, 26), 'project__212': 'Unassigned', 'week_number__212': 52, 'task_description__212': 'Compiling report for Hiland', 'created_at__212': datetime.datetime(2025, 2, 11, 22, 21, 13, 141682), 'hours__212': 8.0, 'customer__212': 'Unassigned', 'month__212': 'December', 'category__213': 'Other', 'updated_at__213': None, 'subcategory__213': 'Info/File Management', 'date__213': datetime.date(2024, 12, 27), 'project__213': 'Unassigned', 'week_number__213': 52, 'task_description__213': 'Compiling report for Hiland', 'created_at__213': datetime.datetime(2025, 2, 11, 22, 21, 13, 142809), 'hours__213': 8.0, 'customer__213': 'Unassigned', 'month__213': 'December', 'category__214': 'Other', 'updated_at__214': None, 'subcategory__214': 'Info/File Management', 'date__214': datetime.date(2024, 12, 30), 'project__214': 'Unassigned', 'week_number__214': 1, 'task_description__214': 'Compiling report for Hiland', 'created_at__214': datetime.datetime(2025, 2, 11, 22, 21, 13, 143930), 'hours__214': 8.0, 'customer__214': 'Unassigned', 'month__214': 'December', 'category__215': 'Other', 'updated_at__215': None, 'subcategory__215': 'Holidays', 'date__215': datetime.date(2024, 12, 31), 'project__215': 'Unassigned', 'week_number__215': 1, 'task_description__215': 'NYE', 'created_at__215': datetime.datetime(2025, 2, 11, 22, 21, 13, 145037), 'hours__215': 8.0, 'customer__215': 'Unassigned', 'month__215': 'December'}]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "context": {}}
{"timestamp": "2025-02-11T22:21:13.281006", "level": "ERROR", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "Database session error: 400: (psycopg2.errors.ForeignKeyViolation) insert or update on table \"time_entries\" violates foreign key constraint \"time_entries_project_fkey\"\nDETAIL:  Key (project)=(Wichita, KS) is not present in table \"projects\".\n\n[SQL: INSERT INTO time_entries (week_number, month, category, subcategory, customer, project, task_description, hours, date, created_at, updated_at) SELECT p0::INTEGER, p1::VARCHAR, p2::VARCHAR, p3::VARCHAR, p4::VARCHAR, p5::VARCHAR, p6::VARCHAR, p7::FLOAT ... 46974 characters truncated ... , p8, p9, p10, sen_counter) ORDER BY sen_counter RETURNING time_entries.id, time_entries.id AS id__1]\n[parameters: {'category__0': 'Other', 'updated_at__0': None, 'subcategory__0': 'Other Training', 'date__0': datetime.date(2024, 10, 7), 'project__0': 'Unassigned', 'week_number__0': 41, 'task_description__0': 'New hire orientation', 'created_at__0': datetime.datetime(2025, 2, 11, 22, 21, 12, 881920), 'hours__0': 6.0, 'customer__0': 'Unassigned', 'month__0': 'October', 'category__1': 'Other', 'updated_at__1': None, 'subcategory__1': 'Other Training', 'date__1': datetime.date(2024, 10, 7), 'project__1': 'Unassigned', 'week_number__1': 41, 'task_description__1': 'Andrew<>Joseph ', 'created_at__1': datetime.datetime(2025, 2, 11, 22, 21, 12, 883099), 'hours__1': 2.0, 'customer__1': 'Unassigned', 'month__1': 'October', 'category__2': 'Other', 'updated_at__2': None, 'subcategory__2': 'Other Training', 'date__2': datetime.date(2024, 10, 8), 'project__2': 'Unassigned', 'week_number__2': 41, 'task_description__2': 'Andrew<>Joseph ', 'created_at__2': datetime.datetime(2025, 2, 11, 22, 21, 12, 884283), 'hours__2': 2.0, 'customer__2': 'Unassigned', 'month__2': 'October', 'category__3': 'Other', 'updated_at__3': None, 'subcategory__3': 'Info/File Management', 'date__3': datetime.date(2024, 10, 8), 'project__3': 'Unassigned', 'week_number__3': 41, 'task_description__3': 'I-9 Meeting', 'created_at__3': datetime.datetime(2025, 2, 11, 22, 21, 12, 885572), 'hours__3': 1.0, 'customer__3': 'Unassigned', 'month__3': 'October', 'category__4': 'Other', 'updated_at__4': None, 'subcategory__4': 'Safety Training/Reporting', 'date__4': datetime.date(2024, 10, 8), 'project__4': 'Unassigned', 'week_number__4': 41 ... 2276 parameters truncated ... 'week_number__211': 52, 'task_description__211': 'Christmas Day', 'created_at__211': datetime.datetime(2025, 2, 11, 22, 21, 13, 140568), 'hours__211': 8.0, 'customer__211': 'Unassigned', 'month__211': 'December', 'category__212': 'Other', 'updated_at__212': None, 'subcategory__212': 'Info/File Management', 'date__212': datetime.date(2024, 12, 26), 'project__212': 'Unassigned', 'week_number__212': 52, 'task_description__212': 'Compiling report for Hiland', 'created_at__212': datetime.datetime(2025, 2, 11, 22, 21, 13, 141682), 'hours__212': 8.0, 'customer__212': 'Unassigned', 'month__212': 'December', 'category__213': 'Other', 'updated_at__213': None, 'subcategory__213': 'Info/File Management', 'date__213': datetime.date(2024, 12, 27), 'project__213': 'Unassigned', 'week_number__213': 52, 'task_description__213': 'Compiling report for Hiland', 'created_at__213': datetime.datetime(2025, 2, 11, 22, 21, 13, 142809), 'hours__213': 8.0, 'customer__213': 'Unassigned', 'month__213': 'December', 'category__214': 'Other', 'updated_at__214': None, 'subcategory__214': 'Info/File Management', 'date__214': datetime.date(2024, 12, 30), 'project__214': 'Unassigned', 'week_number__214': 1, 'task_description__214': 'Compiling report for Hiland', 'created_at__214': datetime.datetime(2025, 2, 11, 22, 21, 13, 143930), 'hours__214': 8.0, 'customer__214': 'Unassigned', 'month__214': 'December', 'category__215': 'Other', 'updated_at__215': None, 'subcategory__215': 'Holidays', 'date__215': datetime.date(2024, 12, 31), 'project__215': 'Unassigned', 'week_number__215': 1, 'task_description__215': 'NYE', 'created_at__215': datetime.datetime(2025, 2, 11, 22, 21, 13, 145037), 'hours__215': 8.0, 'customer__215': 'Unassigned', 'month__215': 'December'}]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)", "context": {}}
{"timestamp": "2025-02-11T22:21:13.329890", "level": "ERROR", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "Database session error details:", "context": {}, "exception": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2118, in _exec_insertmany_context\n    dialect.do_execute(\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\npsycopg2.errors.ForeignKeyViolation: insert or update on table \"time_entries\" violates foreign key constraint \"time_entries_project_fkey\"\nDETAIL:  Key (project)=(Wichita, KS) is not present in table \"projects\".\n\n\nThe above exception was the direct cause of the following exception:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/services/timesheet_service.py\", line 166, in upload_timesheet\n    entries = self.repository.import_excel(self.db, contents)\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/database/timesheet_repository.py\", line 103, in import_excel\n    return self.bulk_create(db, entries)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/database/timesheet_repository.py\", line 38, in bulk_create\n    db.commit()\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 2028, in commit\n    trans.commit(_to_root=True)\n  File \"<string>\", line 2, in commit\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1313, in commit\n    self._prepare_impl()\n  File \"<string>\", line 2, in _prepare_impl\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/state_changes.py\", line 139, in _go\n    ret_value = fn(self, *arg, **kw)\n                ^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 1288, in _prepare_impl\n    self.session.flush()\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4352, in flush\n    self._flush(objects)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4487, in _flush\n    with util.safe_reraise():\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/util/langhelpers.py\", line 146, in __exit__\n    raise exc_value.with_traceback(exc_tb)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/session.py\", line 4448, in _flush\n    flush_context.execute()\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 466, in execute\n    rec.execute(self)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/unitofwork.py\", line 642, in execute\n    util.preloaded.orm_persistence.save_obj(\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 93, in save_obj\n    _emit_insert_statements(\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/orm/persistence.py\", line 1143, in _emit_insert_statements\n    result = connection.execute(\n             ^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1418, in execute\n    return meth(\n           ^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/sql/elements.py\", line 515, in _execute_on_connection\n    return connection._execute_clauseelement(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1640, in _execute_clauseelement\n    ret = self._execute_context(\n          ^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 1844, in _execute_context\n    return self._exec_insertmany_context(dialect, context)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2126, in _exec_insertmany_context\n    self._handle_dbapi_exception(\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2355, in _handle_dbapi_exception\n    raise sqlalchemy_exception.with_traceback(exc_info[2]) from e\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/base.py\", line 2118, in _exec_insertmany_context\n    dialect.do_execute(\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/sqlalchemy/engine/default.py\", line 941, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.IntegrityError: (psycopg2.errors.ForeignKeyViolation) insert or update on table \"time_entries\" violates foreign key constraint \"time_entries_project_fkey\"\nDETAIL:  Key (project)=(Wichita, KS) is not present in table \"projects\".\n\n[SQL: INSERT INTO time_entries (week_number, month, category, subcategory, customer, project, task_description, hours, date, created_at, updated_at) SELECT p0::INTEGER, p1::VARCHAR, p2::VARCHAR, p3::VARCHAR, p4::VARCHAR, p5::VARCHAR, p6::VARCHAR, p7::FLOAT ... 46974 characters truncated ... , p8, p9, p10, sen_counter) ORDER BY sen_counter RETURNING time_entries.id, time_entries.id AS id__1]\n[parameters: {'category__0': 'Other', 'updated_at__0': None, 'subcategory__0': 'Other Training', 'date__0': datetime.date(2024, 10, 7), 'project__0': 'Unassigned', 'week_number__0': 41, 'task_description__0': 'New hire orientation', 'created_at__0': datetime.datetime(2025, 2, 11, 22, 21, 12, 881920), 'hours__0': 6.0, 'customer__0': 'Unassigned', 'month__0': 'October', 'category__1': 'Other', 'updated_at__1': None, 'subcategory__1': 'Other Training', 'date__1': datetime.date(2024, 10, 7), 'project__1': 'Unassigned', 'week_number__1': 41, 'task_description__1': 'Andrew<>Joseph ', 'created_at__1': datetime.datetime(2025, 2, 11, 22, 21, 12, 883099), 'hours__1': 2.0, 'customer__1': 'Unassigned', 'month__1': 'October', 'category__2': 'Other', 'updated_at__2': None, 'subcategory__2': 'Other Training', 'date__2': datetime.date(2024, 10, 8), 'project__2': 'Unassigned', 'week_number__2': 41, 'task_description__2': 'Andrew<>Joseph ', 'created_at__2': datetime.datetime(2025, 2, 11, 22, 21, 12, 884283), 'hours__2': 2.0, 'customer__2': 'Unassigned', 'month__2': 'October', 'category__3': 'Other', 'updated_at__3': None, 'subcategory__3': 'Info/File Management', 'date__3': datetime.date(2024, 10, 8), 'project__3': 'Unassigned', 'week_number__3': 41, 'task_description__3': 'I-9 Meeting', 'created_at__3': datetime.datetime(2025, 2, 11, 22, 21, 12, 885572), 'hours__3': 1.0, 'customer__3': 'Unassigned', 'month__3': 'October', 'category__4': 'Other', 'updated_at__4': None, 'subcategory__4': 'Safety Training/Reporting', 'date__4': datetime.date(2024, 10, 8), 'project__4': 'Unassigned', 'week_number__4': 41 ... 2276 parameters truncated ... 'week_number__211': 52, 'task_description__211': 'Christmas Day', 'created_at__211': datetime.datetime(2025, 2, 11, 22, 21, 13, 140568), 'hours__211': 8.0, 'customer__211': 'Unassigned', 'month__211': 'December', 'category__212': 'Other', 'updated_at__212': None, 'subcategory__212': 'Info/File Management', 'date__212': datetime.date(2024, 12, 26), 'project__212': 'Unassigned', 'week_number__212': 52, 'task_description__212': 'Compiling report for Hiland', 'created_at__212': datetime.datetime(2025, 2, 11, 22, 21, 13, 141682), 'hours__212': 8.0, 'customer__212': 'Unassigned', 'month__212': 'December', 'category__213': 'Other', 'updated_at__213': None, 'subcategory__213': 'Info/File Management', 'date__213': datetime.date(2024, 12, 27), 'project__213': 'Unassigned', 'week_number__213': 52, 'task_description__213': 'Compiling report for Hiland', 'created_at__213': datetime.datetime(2025, 2, 11, 22, 21, 13, 142809), 'hours__213': 8.0, 'customer__213': 'Unassigned', 'month__213': 'December', 'category__214': 'Other', 'updated_at__214': None, 'subcategory__214': 'Info/File Management', 'date__214': datetime.date(2024, 12, 30), 'project__214': 'Unassigned', 'week_number__214': 1, 'task_description__214': 'Compiling report for Hiland', 'created_at__214': datetime.datetime(2025, 2, 11, 22, 21, 13, 143930), 'hours__214': 8.0, 'customer__214': 'Unassigned', 'month__214': 'December', 'category__215': 'Other', 'updated_at__215': None, 'subcategory__215': 'Holidays', 'date__215': datetime.date(2024, 12, 31), 'project__215': 'Unassigned', 'week_number__215': 1, 'task_description__215': 'NYE', 'created_at__215': datetime.datetime(2025, 2, 11, 22, 21, 13, 145037), 'hours__215': 8.0, 'customer__215': 'Unassigned', 'month__215': 'December'}]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/database/database.py\", line 113, in get_db\n    yield db\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/concurrency.py\", line 27, in contextmanager_in_threadpool\n    yield await run_in_threadpool(cm.__enter__)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 212, in run_endpoint_function\n    return await dependant.call(**values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 259, in upload_timesheet\n    result = await service.upload_timesheet(file)\n             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/services/timesheet_service.py\", line 204, in upload_timesheet\n    raise HTTPException(status_code=400, detail=str(e))\nfastapi.exceptions.HTTPException: 400: (psycopg2.errors.ForeignKeyViolation) insert or update on table \"time_entries\" violates foreign key constraint \"time_entries_project_fkey\"\nDETAIL:  Key (project)=(Wichita, KS) is not present in table \"projects\".\n\n[SQL: INSERT INTO time_entries (week_number, month, category, subcategory, customer, project, task_description, hours, date, created_at, updated_at) SELECT p0::INTEGER, p1::VARCHAR, p2::VARCHAR, p3::VARCHAR, p4::VARCHAR, p5::VARCHAR, p6::VARCHAR, p7::FLOAT ... 46974 characters truncated ... , p8, p9, p10, sen_counter) ORDER BY sen_counter RETURNING time_entries.id, time_entries.id AS id__1]\n[parameters: {'category__0': 'Other', 'updated_at__0': None, 'subcategory__0': 'Other Training', 'date__0': datetime.date(2024, 10, 7), 'project__0': 'Unassigned', 'week_number__0': 41, 'task_description__0': 'New hire orientation', 'created_at__0': datetime.datetime(2025, 2, 11, 22, 21, 12, 881920), 'hours__0': 6.0, 'customer__0': 'Unassigned', 'month__0': 'October', 'category__1': 'Other', 'updated_at__1': None, 'subcategory__1': 'Other Training', 'date__1': datetime.date(2024, 10, 7), 'project__1': 'Unassigned', 'week_number__1': 41, 'task_description__1': 'Andrew<>Joseph ', 'created_at__1': datetime.datetime(2025, 2, 11, 22, 21, 12, 883099), 'hours__1': 2.0, 'customer__1': 'Unassigned', 'month__1': 'October', 'category__2': 'Other', 'updated_at__2': None, 'subcategory__2': 'Other Training', 'date__2': datetime.date(2024, 10, 8), 'project__2': 'Unassigned', 'week_number__2': 41, 'task_description__2': 'Andrew<>Joseph ', 'created_at__2': datetime.datetime(2025, 2, 11, 22, 21, 12, 884283), 'hours__2': 2.0, 'customer__2': 'Unassigned', 'month__2': 'October', 'category__3': 'Other', 'updated_at__3': None, 'subcategory__3': 'Info/File Management', 'date__3': datetime.date(2024, 10, 8), 'project__3': 'Unassigned', 'week_number__3': 41, 'task_description__3': 'I-9 Meeting', 'created_at__3': datetime.datetime(2025, 2, 11, 22, 21, 12, 885572), 'hours__3': 1.0, 'customer__3': 'Unassigned', 'month__3': 'October', 'category__4': 'Other', 'updated_at__4': None, 'subcategory__4': 'Safety Training/Reporting', 'date__4': datetime.date(2024, 10, 8), 'project__4': 'Unassigned', 'week_number__4': 41 ... 2276 parameters truncated ... 'week_number__211': 52, 'task_description__211': 'Christmas Day', 'created_at__211': datetime.datetime(2025, 2, 11, 22, 21, 13, 140568), 'hours__211': 8.0, 'customer__211': 'Unassigned', 'month__211': 'December', 'category__212': 'Other', 'updated_at__212': None, 'subcategory__212': 'Info/File Management', 'date__212': datetime.date(2024, 12, 26), 'project__212': 'Unassigned', 'week_number__212': 52, 'task_description__212': 'Compiling report for Hiland', 'created_at__212': datetime.datetime(2025, 2, 11, 22, 21, 13, 141682), 'hours__212': 8.0, 'customer__212': 'Unassigned', 'month__212': 'December', 'category__213': 'Other', 'updated_at__213': None, 'subcategory__213': 'Info/File Management', 'date__213': datetime.date(2024, 12, 27), 'project__213': 'Unassigned', 'week_number__213': 52, 'task_description__213': 'Compiling report for Hiland', 'created_at__213': datetime.datetime(2025, 2, 11, 22, 21, 13, 142809), 'hours__213': 8.0, 'customer__213': 'Unassigned', 'month__213': 'December', 'category__214': 'Other', 'updated_at__214': None, 'subcategory__214': 'Info/File Management', 'date__214': datetime.date(2024, 12, 30), 'project__214': 'Unassigned', 'week_number__214': 1, 'task_description__214': 'Compiling report for Hiland', 'created_at__214': datetime.datetime(2025, 2, 11, 22, 21, 13, 143930), 'hours__214': 8.0, 'customer__214': 'Unassigned', 'month__214': 'December', 'category__215': 'Other', 'updated_at__215': None, 'subcategory__215': 'Holidays', 'date__215': datetime.date(2024, 12, 31), 'project__215': 'Unassigned', 'week_number__215': 1, 'task_description__215': 'NYE', 'created_at__215': datetime.datetime(2025, 2, 11, 22, 21, 13, 145037), 'hours__215': 8.0, 'customer__215': 'Unassigned', 'month__215': 'December'}]\n(Background on this error at: https://sqlalche.me/e/20/gkpj)"}
{"timestamp": "2025-02-11T22:21:13.332314", "level": "DEBUG", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "Database session closed", "context": {}}
{"timestamp": "2025-02-11T22:21:13.333192", "level": "WARNING", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "Request failed with status 400", "context": {"correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "status_code": 400, "method": "POST", "url": "http://6ed7ce35-85b3-498b-9e9b-4d63631ed8e3-00-2owzgyvztotfg.worf.replit.dev/time-entries/upload/", "process_time_ms": "789.07", "response_headers": {"content-length": "4088", "content-type": "application/json", "access-control-allow-origin": "*", "access-control-expose-headers": "X-Total-Count, X-Correlation-ID"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "172.31.128.11", "path": "/time-entries/upload/", "origin": "https://6ed7ce35-85b3-498b-9e9b-4d63631ed8e3-00-2owzgyvztotfg.worf.replit.dev:8080", "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T22:21:13.333720", "level": "DEBUG", "correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "edd203c0-ddf8-4590-a6cb-c2f500c995df", "method": "POST", "path": "/time-entries/upload/", "status_code": 400}}
INFO:     172.31.128.11:35464 - "POST /time-entries/upload/ HTTP/1.1" 400 Bad Request