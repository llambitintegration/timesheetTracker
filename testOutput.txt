============================= test session starts ==============================
platform linux -- Python 3.11.10, pytest-8.3.4, pluggy-1.5.0 -- /home/runner/workspace/.pythonlibs/bin/python
cachedir: .pytest_cache
rootdir: /home/runner/workspace
configfile: pyproject.toml
plugins: anyio-4.7.0, asyncio-0.25.2, cov-6.0.0
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None
collecting ... collected 23 items

tests/test_csv_validation.py::test_parse_csv_with_valid_data FAILED      [  4%]
tests/test_csv_validation.py::test_clean_string_value FAILED             [  8%]
tests/test_csv_validation.py::test_parse_csv_with_empty_rows FAILED      [ 13%]
tests/test_csv_validation.py::test_parse_csv_with_special_characters FAILED [ 17%]
tests/test_csv_validation.py::test_parse_csv_with_missing_values FAILED  [ 21%]
tests/test_csv_validation.py::test_parse_csv_with_invalid_customer_project_mapping FAILED [ 26%]
tests/test_interfaces.py::test_project_interface FAILED                  [ 30%]
tests/test_models.py::test_model_timestamps FAILED                       [ 34%]
tests/test_repositories.py::test_customer_repository_get_by_id FAILED    [ 39%]
tests/test_repositories.py::test_customer_repository_update FAILED       [ 43%]
tests/test_repositories.py::test_customer_repository_delete FAILED       [ 47%]
tests/test_routes.py::test_root_endpoint FAILED                          [ 52%]
tests/test_routes.py::test_create_time_entry FAILED                      [ 56%]
tests/test_routes.py::test_get_time_entries_with_database_query FAILED   [ 60%]
tests/test_routes.py::test_get_time_entries_complex_filtering FAILED     [ 65%]
tests/test_routes.py::test_upload_csv_valid FAILED                       [ 69%]
tests/test_routes.py::test_upload_csv_invalid_format FAILED              [ 73%]
tests/test_routes.py::test_upload_csv_with_validation_errors FAILED      [ 78%]
tests/test_routes.py::test_upload_csv_with_foreign_key_violation FAILED  [ 82%]
tests/test_routes.py::test_upload_csv_with_mismatched_customer_project FAILED [ 86%]
tests/test_routes.py::test_upload_csv_with_multiple_validation_errors FAILED [ 91%]
tests/test_routes.py::test_get_time_entries_with_filters FAILED          [ 95%]
tests/test_routes.py::test_get_time_entries_pagination FAILED            [100%]

=================================== FAILURES ===================================
________________________ test_parse_csv_with_valid_data ________________________

test_csv_file = PosixPath('tests/data/test_timesheet.csv')
setup_test_data = {'customers': [<models.customerModel.Customer object at 0x7f34fd7f5c90>, <models.customerModel.Customer object at 0x7f...project_id=Unassigned, name=Unassigned)>, <Project(id=2, project_id=Project_Magic_Bullet, name=Project Magic Bullet)>]}

    def test_parse_csv_with_valid_data(test_csv_file, setup_test_data):
        """Test parsing a valid CSV file"""
        with open(test_csv_file, 'r') as file:
            entries = parse_csv(file)
    
>       assert len(entries) == 2
E       assert 0 == 2
E        +  where 0 = len([])

tests/test_csv_validation.py:13: AssertionError
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:26.614760", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Starting CSV parsing process", "context": {}}
{"timestamp": "2025-02-11T01:56:26.615458", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Starting raw CSV parsing", "context": {}}
{"timestamp": "2025-02-11T01:56:26.622082", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Successfully read CSV with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:26.622595", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Starting DataFrame cleaning", "context": {}}
{"timestamp": "2025-02-11T01:56:26.623561", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Cleaned DataFrame has 2 rows", "context": {}}
{"timestamp": "2025-02-11T01:56:26.623923", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Processing 2 rows from CSV file", "context": {}}
{"timestamp": "2025-02-11T01:56:26.624624", "level": "ERROR", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Error processing row 1: name 'DEFAULT_CUSTOMER' is not defined", "context": {}}
{"timestamp": "2025-02-11T01:56:26.625282", "level": "ERROR", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Error processing row 2: name 'DEFAULT_CUSTOMER' is not defined", "context": {}}
{"timestamp": "2025-02-11T01:56:26.625578", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Successfully processed 0 valid entries from CSV", "context": {}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting CSV parsing process", "timestamp": "2025-02-11T01:56:26.615241", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Starting raw CSV parsing", "timestamp": "2025-02-11T01:56:26.615567", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Successfully read CSV with 9 columns", "timestamp": "2025-02-11T01:56:26.622231", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Starting DataFrame cleaning", "timestamp": "2025-02-11T01:56:26.622688", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Cleaned DataFrame has 2 rows", "timestamp": "2025-02-11T01:56:26.623650", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Processing 2 rows from CSV file", "timestamp": "2025-02-11T01:56:26.624047", "context": {}}
ERROR    TimesheetTracker:logger.py:32 {"message": "Error processing row 1: name 'DEFAULT_CUSTOMER' is not defined", "timestamp": "2025-02-11T01:56:26.624838", "context": {}}
ERROR    TimesheetTracker:logger.py:32 {"message": "Error processing row 2: name 'DEFAULT_CUSTOMER' is not defined", "timestamp": "2025-02-11T01:56:26.625364", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully processed 0 valid entries from CSV", "timestamp": "2025-02-11T01:56:26.625660", "context": {}}
___________________________ test_clean_string_value ____________________________

    def test_clean_string_value():
        """Test string cleaning functionality"""
        assert clean_string_value("  Test  ") == "Test"
        assert clean_string_value("") == ""
        assert clean_string_value(None) == ""
>       assert clean_string_value("other training", field_type="category") == "Other Training"
E       TypeError: clean_string_value() got an unexpected keyword argument 'field_type'

tests/test_csv_validation.py:24: TypeError
________________________ test_parse_csv_with_empty_rows ________________________

tmp_path = PosixPath('/tmp/pytest-of-runner/pytest-2/test_parse_csv_with_empty_rows0')

    def test_parse_csv_with_empty_rows(tmp_path):
        """Test CSV parsing with empty rows"""
        csv_file = tmp_path / "empty_rows.csv"
        csv_content = """Week Number,Month,Category,Subcategory,Customer,Project,Task Description,Hours,Date
    41,October,Other,Other Training,Unassigned,Unassigned,Task 1,8.0,2024-10-07
    41,October,Other,Other Training,Unassigned,Unassigned,Task 2,8.0,2024-10-07"""
        csv_file.write_text(csv_content)
    
        with open(csv_file, 'r') as file:
            entries = parse_csv(file)
>       assert len(entries) == 2  # Empty rows should be ignored
E       assert 0 == 2
E        +  where 0 = len([])

tests/test_csv_validation.py:96: AssertionError
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:26.713097", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Starting CSV parsing process", "context": {}}
{"timestamp": "2025-02-11T01:56:26.713350", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Starting raw CSV parsing", "context": {}}
{"timestamp": "2025-02-11T01:56:26.714869", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Successfully read CSV with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:26.715218", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Starting DataFrame cleaning", "context": {}}
{"timestamp": "2025-02-11T01:56:26.715844", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Cleaned DataFrame has 2 rows", "context": {}}
{"timestamp": "2025-02-11T01:56:26.716161", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Processing 2 rows from CSV file", "context": {}}
{"timestamp": "2025-02-11T01:56:26.716651", "level": "ERROR", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Error processing row 1: name 'DEFAULT_CUSTOMER' is not defined", "context": {}}
{"timestamp": "2025-02-11T01:56:26.717035", "level": "ERROR", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Error processing row 2: name 'DEFAULT_CUSTOMER' is not defined", "context": {}}
{"timestamp": "2025-02-11T01:56:26.717267", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Successfully processed 0 valid entries from CSV", "context": {}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting CSV parsing process", "timestamp": "2025-02-11T01:56:26.713206", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Starting raw CSV parsing", "timestamp": "2025-02-11T01:56:26.713405", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Successfully read CSV with 9 columns", "timestamp": "2025-02-11T01:56:26.714947", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Starting DataFrame cleaning", "timestamp": "2025-02-11T01:56:26.715296", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Cleaned DataFrame has 2 rows", "timestamp": "2025-02-11T01:56:26.715919", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Processing 2 rows from CSV file", "timestamp": "2025-02-11T01:56:26.716241", "context": {}}
ERROR    TimesheetTracker:logger.py:32 {"message": "Error processing row 1: name 'DEFAULT_CUSTOMER' is not defined", "timestamp": "2025-02-11T01:56:26.716745", "context": {}}
ERROR    TimesheetTracker:logger.py:32 {"message": "Error processing row 2: name 'DEFAULT_CUSTOMER' is not defined", "timestamp": "2025-02-11T01:56:26.717091", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully processed 0 valid entries from CSV", "timestamp": "2025-02-11T01:56:26.717329", "context": {}}
____________________ test_parse_csv_with_special_characters ____________________

tmp_path = PosixPath('/tmp/pytest-of-runner/pytest-2/test_parse_csv_with_special_ch0')

    def test_parse_csv_with_special_characters(tmp_path):
        """Test CSV parsing with special characters in text fields"""
        csv_file = tmp_path / "special_chars.csv"
        csv_content = """Week Number,Month,Category,Subcategory,Customer,Project,Task Description,Hours,Date
    41,October,Other,Other Training,Test & Co.,Project-123,"Task, with comma",8.0,2024-10-07"""
        csv_file.write_text(csv_content)
    
        with open(csv_file, 'r') as file:
            entries = parse_csv(file)
>       assert len(entries) == 1
E       assert 0 == 1
E        +  where 0 = len([])

tests/test_csv_validation.py:107: AssertionError
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:26.724951", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Starting CSV parsing process", "context": {}}
{"timestamp": "2025-02-11T01:56:26.725212", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Starting raw CSV parsing", "context": {}}
{"timestamp": "2025-02-11T01:56:26.726744", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Successfully read CSV with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:26.727009", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Starting DataFrame cleaning", "context": {}}
{"timestamp": "2025-02-11T01:56:26.727622", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Cleaned DataFrame has 1 rows", "context": {}}
{"timestamp": "2025-02-11T01:56:26.727826", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Processing 1 rows from CSV file", "context": {}}
{"timestamp": "2025-02-11T01:56:26.728240", "level": "ERROR", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Error processing row 1: name 'DEFAULT_CUSTOMER' is not defined", "context": {}}
{"timestamp": "2025-02-11T01:56:26.728469", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Successfully processed 0 valid entries from CSV", "context": {}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting CSV parsing process", "timestamp": "2025-02-11T01:56:26.725038", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Starting raw CSV parsing", "timestamp": "2025-02-11T01:56:26.725294", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Successfully read CSV with 9 columns", "timestamp": "2025-02-11T01:56:26.726814", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Starting DataFrame cleaning", "timestamp": "2025-02-11T01:56:26.727098", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Cleaned DataFrame has 1 rows", "timestamp": "2025-02-11T01:56:26.727687", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Processing 1 rows from CSV file", "timestamp": "2025-02-11T01:56:26.727893", "context": {}}
ERROR    TimesheetTracker:logger.py:32 {"message": "Error processing row 1: name 'DEFAULT_CUSTOMER' is not defined", "timestamp": "2025-02-11T01:56:26.728305", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully processed 0 valid entries from CSV", "timestamp": "2025-02-11T01:56:26.728545", "context": {}}
______________________ test_parse_csv_with_missing_values ______________________

tmp_path = PosixPath('/tmp/pytest-of-runner/pytest-2/test_parse_csv_with_missing_va0')

    def test_parse_csv_with_missing_values(tmp_path):
        """Test CSV parsing with missing values that should use defaults"""
        csv_file = tmp_path / "missing_values.csv"
        csv_content = """Week Number,Month,Category,Subcategory,Customer,Project,Task Description,Hours,Date
    41,October,Other,Other Training,,,Generic task,8.0,2024-10-07"""
        csv_file.write_text(csv_content)
    
        with open(csv_file, 'r') as file:
            entries = parse_csv(file)
>       assert len(entries) == 1
E       assert 0 == 1
E        +  where 0 = len([])

tests/test_csv_validation.py:121: AssertionError
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:26.734434", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Starting CSV parsing process", "context": {}}
{"timestamp": "2025-02-11T01:56:26.734656", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Starting raw CSV parsing", "context": {}}
{"timestamp": "2025-02-11T01:56:26.735957", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Successfully read CSV with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:26.736275", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Starting DataFrame cleaning", "context": {}}
{"timestamp": "2025-02-11T01:56:26.736957", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Cleaned DataFrame has 1 rows", "context": {}}
{"timestamp": "2025-02-11T01:56:26.737220", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Processing 1 rows from CSV file", "context": {}}
{"timestamp": "2025-02-11T01:56:26.737609", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Validation issues detected in row 1, using defaults", "context": {}}
{"timestamp": "2025-02-11T01:56:26.737831", "level": "ERROR", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Error processing row 1: name 'DEFAULT_CUSTOMER' is not defined", "context": {}}
{"timestamp": "2025-02-11T01:56:26.738017", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Successfully processed 0 valid entries from CSV", "context": {}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting CSV parsing process", "timestamp": "2025-02-11T01:56:26.734517", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Starting raw CSV parsing", "timestamp": "2025-02-11T01:56:26.734719", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Successfully read CSV with 9 columns", "timestamp": "2025-02-11T01:56:26.736042", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Starting DataFrame cleaning", "timestamp": "2025-02-11T01:56:26.736356", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Cleaned DataFrame has 1 rows", "timestamp": "2025-02-11T01:56:26.737028", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Processing 1 rows from CSV file", "timestamp": "2025-02-11T01:56:26.737297", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Validation issues detected in row 1, using defaults", "timestamp": "2025-02-11T01:56:26.737684", "context": {}}
ERROR    TimesheetTracker:logger.py:32 {"message": "Error processing row 1: name 'DEFAULT_CUSTOMER' is not defined", "timestamp": "2025-02-11T01:56:26.737891", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully processed 0 valid entries from CSV", "timestamp": "2025-02-11T01:56:26.738089", "context": {}}
_____________ test_parse_csv_with_invalid_customer_project_mapping _____________

test_csv_file = PosixPath('tests/data/test_timesheet.csv')
setup_test_data = {'customers': [<models.customerModel.Customer object at 0x7f34fcb08210>, <models.customerModel.Customer object at 0x7f...project_id=Unassigned, name=Unassigned)>, <Project(id=2, project_id=Project_Magic_Bullet, name=Project Magic Bullet)>]}

    def test_parse_csv_with_invalid_customer_project_mapping(test_csv_file, setup_test_data):
        """Test parsing CSV with invalid customer-project mappings"""
        csv_content = """Week Number,Month,Category,Subcategory,Customer,Project,Task Description,Hours,Date
    41,October,Other,Other Training,Project Magic Bullet,Unassigned,Test task,8.0,2024-10-07
    41,October,Other,Other Training,ECOLAB,NonExistent_Project,Test task,8.0,2024-10-07"""
    
        test_csv_file = Path("tests/data/test_timesheet.csv")
        test_csv_file.parent.mkdir(parents=True, exist_ok=True)
        test_csv_file.write_text(csv_content)
    
        with open(test_csv_file, 'r') as file:
            entries = parse_csv(file)
    
>       assert len(entries) == 2
E       assert 0 == 2
E        +  where 0 = len([])

tests/test_csv_validation.py:184: AssertionError
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:26.781754", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Starting CSV parsing process", "context": {}}
{"timestamp": "2025-02-11T01:56:26.781983", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Starting raw CSV parsing", "context": {}}
{"timestamp": "2025-02-11T01:56:26.783516", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Successfully read CSV with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:26.783794", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Starting DataFrame cleaning", "context": {}}
{"timestamp": "2025-02-11T01:56:26.784421", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Cleaned DataFrame has 2 rows", "context": {}}
{"timestamp": "2025-02-11T01:56:26.784633", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Processing 2 rows from CSV file", "context": {}}
{"timestamp": "2025-02-11T01:56:26.785007", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Validation issues detected in row 1, using defaults", "context": {}}
{"timestamp": "2025-02-11T01:56:26.785233", "level": "ERROR", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Error processing row 1: name 'DEFAULT_CUSTOMER' is not defined", "context": {}}
{"timestamp": "2025-02-11T01:56:26.785535", "level": "DEBUG", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Validation issues detected in row 2, using defaults", "context": {}}
{"timestamp": "2025-02-11T01:56:26.785734", "level": "ERROR", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Error processing row 2: name 'DEFAULT_CUSTOMER' is not defined", "context": {}}
{"timestamp": "2025-02-11T01:56:26.785937", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Successfully processed 0 valid entries from CSV", "context": {}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting CSV parsing process", "timestamp": "2025-02-11T01:56:26.781849", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Starting raw CSV parsing", "timestamp": "2025-02-11T01:56:26.782049", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Successfully read CSV with 9 columns", "timestamp": "2025-02-11T01:56:26.783604", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Starting DataFrame cleaning", "timestamp": "2025-02-11T01:56:26.783882", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Cleaned DataFrame has 2 rows", "timestamp": "2025-02-11T01:56:26.784489", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Processing 2 rows from CSV file", "timestamp": "2025-02-11T01:56:26.784699", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Validation issues detected in row 1, using defaults", "timestamp": "2025-02-11T01:56:26.785072", "context": {}}
ERROR    TimesheetTracker:logger.py:32 {"message": "Error processing row 1: name 'DEFAULT_CUSTOMER' is not defined", "timestamp": "2025-02-11T01:56:26.785295", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Validation issues detected in row 2, using defaults", "timestamp": "2025-02-11T01:56:26.785597", "context": {}}
ERROR    TimesheetTracker:logger.py:32 {"message": "Error processing row 2: name 'DEFAULT_CUSTOMER' is not defined", "timestamp": "2025-02-11T01:56:26.785792", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully processed 0 valid entries from CSV", "timestamp": "2025-02-11T01:56:26.786000", "context": {}}
____________________________ test_project_interface ____________________________

    def test_project_interface():
        """Test Project interface matches API response"""
        response = client.get("/projects")
>       assert response.status_code == 200
E       assert 500 == 200
E        +  where 500 = <Response [500 Internal Server Error]>.status_code

tests/test_interfaces.py:55: AssertionError
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:26.802282", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "url": "http://testserver/projects", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/projects"}}
{"timestamp": "2025-02-11T01:56:26.803224", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database session created", "context": {}}
{"timestamp": "2025-02-11T01:56:26.803758", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "ProjectRepository initialized", "context": {}}
{"timestamp": "2025-02-11T01:56:26.804058", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "ProjectService initialized with database session", "context": {}}
{"timestamp": "2025-02-11T01:56:26.804432", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Fetching projects with offset=0, limit=100", "context": {}}
{"timestamp": "2025-02-11T01:56:26.804687", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Fetching all projects with skip=0, limit=100", "context": {}}
{"timestamp": "2025-02-11T01:56:27.152272", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Retrieved 6 projects", "context": {}}
{"timestamp": "2025-02-11T01:56:27.152628", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Retrieved 6 projects", "context": {}}
{"timestamp": "2025-02-11T01:56:27.153865", "level": "ERROR", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database session error: 6 validation errors:\n  {'type': 'string_type', 'loc': ('response', 0, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 1, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 2, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 3, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 4, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 5, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n", "context": {}}
{"timestamp": "2025-02-11T01:56:27.155692", "level": "ERROR", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database session error details:", "context": {}, "exception": "Traceback (most recent call last):\n  File \"/home/runner/workspace/database/database.py\", line 113, in get_db\n    yield db\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/concurrency.py\", line 27, in contextmanager_in_threadpool\n    yield await run_in_threadpool(cm.__enter__)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 327, in app\n    content = await serialize_response(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 176, in serialize_response\n    raise ResponseValidationError(\nfastapi.exceptions.ResponseValidationError: 6 validation errors:\n  {'type': 'string_type', 'loc': ('response', 0, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 1, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 2, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 3, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 4, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 5, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n"}
{"timestamp": "2025-02-11T01:56:27.176217", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database session closed", "context": {}}
{"timestamp": "2025-02-11T01:56:27.178806", "level": "ERROR", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with exception", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "ResponseValidationError", "error_message": "6 validation errors:\n  {'type': 'string_type', 'loc': ('response', 0, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 1, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 2, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 3, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 4, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 5, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 327, in app\n    content = await serialize_response(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 176, in serialize_response\n    raise ResponseValidationError(\nfastapi.exceptions.ResponseValidationError: 6 validation errors:\n  {'type': 'string_type', 'loc': ('response', 0, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 1, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 2, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 3, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 4, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 5, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n\n", "request_method": "GET", "request_url": "http://testserver/projects", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/projects", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:27.179848", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": null, "method": "GET", "path": "/projects", "status_code": 500}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:26.802390", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "url": "http://testserver/projects", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/projects"}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Database session created", "timestamp": "2025-02-11T01:56:26.803360", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "ProjectRepository initialized", "timestamp": "2025-02-11T01:56:26.803870", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "ProjectService initialized with database session", "timestamp": "2025-02-11T01:56:26.804242", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Fetching projects with offset=0, limit=100", "timestamp": "2025-02-11T01:56:26.804517", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Fetching all projects with skip=0, limit=100", "timestamp": "2025-02-11T01:56:26.804762", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Retrieved 6 projects", "timestamp": "2025-02-11T01:56:27.152397", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Retrieved 6 projects", "timestamp": "2025-02-11T01:56:27.152707", "context": {}}
ERROR    TimesheetTracker:logger.py:32 {"message": "Database session error: 6 validation errors:\n  {'type': 'string_type', 'loc': ('response', 0, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 1, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 2, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 3, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 4, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 5, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n", "timestamp": "2025-02-11T01:56:27.154017", "context": {}}
ERROR    TimesheetTracker:logger.py:32 {"message": "Database session error details:", "timestamp": "2025-02-11T01:56:27.156389", "context": {}}
Traceback (most recent call last):
  File "/home/runner/workspace/database/database.py", line 113, in get_db
    yield db
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/concurrency.py", line 27, in contextmanager_in_threadpool
    yield await run_in_threadpool(cm.__enter__)
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py", line 327, in app
    content = await serialize_response(
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py", line 176, in serialize_response
    raise ResponseValidationError(
fastapi.exceptions.ResponseValidationError: 6 validation errors:
  {'type': 'string_type', 'loc': ('response', 0, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}
  {'type': 'string_type', 'loc': ('response', 1, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}
  {'type': 'string_type', 'loc': ('response', 2, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}
  {'type': 'string_type', 'loc': ('response', 3, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}
  {'type': 'string_type', 'loc': ('response', 4, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}
  {'type': 'string_type', 'loc': ('response', 5, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}

DEBUG    TimesheetTracker:logger.py:32 {"message": "Database session closed", "timestamp": "2025-02-11T01:56:27.176473", "context": {}}
ERROR    TimesheetTracker:logger.py:29 {"message": "Request failed with exception", "timestamp": "2025-02-11T01:56:27.179440", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "ResponseValidationError", "error_message": "6 validation errors:\n  {'type': 'string_type', 'loc': ('response', 0, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 1, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 2, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 3, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 4, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 5, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 327, in app\n    content = await serialize_response(\n              ^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 176, in serialize_response\n    raise ResponseValidationError(\nfastapi.exceptions.ResponseValidationError: 6 validation errors:\n  {'type': 'string_type', 'loc': ('response', 0, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 1, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 2, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 3, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 4, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n  {'type': 'string_type', 'loc': ('response', 5, 'project_manager'), 'msg': 'Input should be a valid string', 'input': None}\n\n", "request_method": "GET", "request_url": "http://testserver/projects", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/projects", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:27.179961", "context": {"correlation_id": null, "method": "GET", "path": "/projects", "status_code": 500}}
____________________________ test_model_timestamps _____________________________

db_session = <sqlalchemy.orm.session.Session object at 0x7f34fcb11790>

    def test_model_timestamps(db_session):
        """Test model timestamps are automatically set"""
        customer = Customer(
            name="Timestamp Test",
            contact_email="timestamp@test.com"
        )
        db_session.add(customer)
        db_session.commit()
    
        assert customer.created_at is not None
        assert customer.updated_at is None  # Should be None until updated
    
        customer.industry = "Updated Industry"
        db_session.commit()
    
        assert customer.updated_at is not None  # Should be set after update
>       assert customer.updated_at > customer.created_at
E       assert datetime.datetime(2025, 2, 11, 1, 56, 27) > datetime.datetime(2025, 2, 11, 1, 56, 27)
E        +  where datetime.datetime(2025, 2, 11, 1, 56, 27) = <models.customerModel.Customer object at 0x7f34fcfb5f90>.updated_at
E        +  and   datetime.datetime(2025, 2, 11, 1, 56, 27) = <models.customerModel.Customer object at 0x7f34fcfb5f90>.created_at

tests/test_models.py:130: AssertionError
______________________ test_customer_repository_get_by_id ______________________

db_session = <sqlalchemy.orm.session.Session object at 0x7f34fcb2dd90>

    def test_customer_repository_get_by_id(db_session):
        """Test retrieving a customer by ID"""
        repo = CustomerRepository()
        customer = Customer(
            name="Get By ID Test",
            contact_email="getbyid@test.com"
        )
    
        created = repo.create(db_session, customer)
>       retrieved = repo.get_by_id(db_session, created.id)
E       AttributeError: 'CustomerRepository' object has no attribute 'get_by_id'

tests/test_repositories.py:33: AttributeError
_______________________ test_customer_repository_update ________________________

db_session = <sqlalchemy.orm.session.Session object at 0x7f34fb70c050>

    def test_customer_repository_update(db_session):
        """Test updating a customer"""
        repo = CustomerRepository()
        customer = Customer(
            name="Update Test",
            contact_email="update@test.com",
            industry="Old Industry"
        )
    
        created = repo.create(db_session, customer)
        created.industry = "New Industry"
        updated = repo.update(db_session, created)
    
        assert updated.industry == "New Industry"
>       retrieved = repo.get_by_id(db_session, created.id)
E       AttributeError: 'CustomerRepository' object has no attribute 'get_by_id'

tests/test_repositories.py:86: AttributeError
_______________________ test_customer_repository_delete ________________________

db_session = <sqlalchemy.orm.session.Session object at 0x7f34fcbfb6d0>

    def test_customer_repository_delete(db_session):
        """Test deleting a customer"""
        repo = CustomerRepository()
        customer = Customer(
            name="Delete Test",
            contact_email="delete@test.com"
        )
    
        created = repo.create(db_session, customer)
>       assert repo.get_by_id(db_session, created.id) is not None
E       AttributeError: 'CustomerRepository' object has no attribute 'get_by_id'

tests/test_repositories.py:98: AttributeError
______________________________ test_root_endpoint ______________________________

client = <starlette.testclient.TestClient object at 0x7f34fcb28750>

    def test_root_endpoint(client):
        """Test the root endpoint returns correct welcome message"""
        response = client.get("/")
>       assert response.status_code == 200
E       assert 404 == 200
E        +  where 404 = <Response [404 Not Found]>.status_code

tests/test_routes.py:13: AssertionError
---------------------------- Captured stdout setup -----------------------------
{"timestamp": "2025-02-11T01:56:27.470694", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Starting FastAPI server", "context": {}}
{"timestamp": "2025-02-11T01:56:27.471045", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection on startup", "context": {}}
{"timestamp": "2025-02-11T01:56:27.471346", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection and schema", "context": {}}
{"timestamp": "2025-02-11T01:56:27.530900", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database driver: psycopg2", "context": {}}
{"timestamp": "2025-02-11T01:56:27.531520", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database dialect: postgresql", "context": {}}
{"timestamp": "2025-02-11T01:56:27.531942", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Successfully connected to database", "context": {}}
{"timestamp": "2025-02-11T01:56:27.749401", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Found 5 tables in database", "context": {}}
{"timestamp": "2025-02-11T01:56:27.749966", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expected tables: time_entries, projects, customers, project_managers", "context": {}}
{"timestamp": "2025-02-11T01:56:27.893101", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table customers exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:27.976900", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table projects exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:28.060546", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table project_managers exists with 5 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:28.144563", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table time_entries exists with 12 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:28.144945", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database verification completed successfully", "context": {}}
{"timestamp": "2025-02-11T01:56:28.166213", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "=== CORS Configuration ===", "context": {}}
{"timestamp": "2025-02-11T01:56:28.166697", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Origins: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:28.167398", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "context": {}}
{"timestamp": "2025-02-11T01:56:28.167810", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allow Credentials: False", "context": {}}
{"timestamp": "2025-02-11T01:56:28.168376", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Headers: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:28.168749", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "context": {}}
------------------------------ Captured log setup ------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting FastAPI server", "timestamp": "2025-02-11T01:56:27.470867", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection on startup", "timestamp": "2025-02-11T01:56:27.471161", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection and schema", "timestamp": "2025-02-11T01:56:27.471454", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database driver: psycopg2", "timestamp": "2025-02-11T01:56:27.531058", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database dialect: postgresql", "timestamp": "2025-02-11T01:56:27.531643", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully connected to database", "timestamp": "2025-02-11T01:56:27.532100", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Found 5 tables in database", "timestamp": "2025-02-11T01:56:27.749572", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expected tables: time_entries, projects, customers, project_managers", "timestamp": "2025-02-11T01:56:27.750093", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table customers exists with 9 columns", "timestamp": "2025-02-11T01:56:27.893301", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table projects exists with 9 columns", "timestamp": "2025-02-11T01:56:27.977021", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table project_managers exists with 5 columns", "timestamp": "2025-02-11T01:56:28.060707", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table time_entries exists with 12 columns", "timestamp": "2025-02-11T01:56:28.144702", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database verification completed successfully", "timestamp": "2025-02-11T01:56:28.145093", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "=== CORS Configuration ===", "timestamp": "2025-02-11T01:56:28.166403", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Origins: '*'", "timestamp": "2025-02-11T01:56:28.166902", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "timestamp": "2025-02-11T01:56:28.167521", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allow Credentials: False", "timestamp": "2025-02-11T01:56:28.167978", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Headers: '*'", "timestamp": "2025-02-11T01:56:28.168477", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "timestamp": "2025-02-11T01:56:28.168853", "context": {}}
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:28.171289", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "url": "http://testserver/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/"}}
{"timestamp": "2025-02-11T01:56:28.172030", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 404", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 404, "method": "GET", "url": "http://testserver/", "process_time_ms": "0.94", "response_headers": {"content-length": "22", "content-type": "application/json"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:28.172579", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "path": "/", "status_code": 404}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:28.171448", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "url": "http://testserver/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 404", "timestamp": "2025-02-11T01:56:28.172239", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 404, "method": "GET", "url": "http://testserver/", "process_time_ms": "0.94", "response_headers": {"content-length": "22", "content-type": "application/json"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:28.172679", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "path": "/", "status_code": 404}}
--------------------------- Captured stdout teardown ---------------------------
{"timestamp": "2025-02-11T01:56:28.180987", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Shutting down FastAPI server", "context": {}}
---------------------------- Captured log teardown -----------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Shutting down FastAPI server", "timestamp": "2025-02-11T01:56:28.181125", "context": {}}
____________________________ test_create_time_entry ____________________________

client = <starlette.testclient.TestClient object at 0x7f350a18a210>
setup_test_data = {'customers': [<models.customerModel.Customer object at 0x7f34fcbea7d0>, <models.customerModel.Customer object at 0x7f...project_id=Unassigned, name=Unassigned)>, <Project(id=2, project_id=Project_Magic_Bullet, name=Project Magic Bullet)>]}

    def test_create_time_entry(client, setup_test_data):
        """Test creating a single time entry"""
        entry_data = {
            "week_number": 41,
            "month": "October",
            "category": "Other",
            "subcategory": "Other Training",
            "customer": "ECOLAB",
            "project": "Project_Magic_Bullet",
            "task_description": "Test task",
            "hours": 8.0,
            "date": "2024-10-07"
        }
        response = client.post("/time-entries/", json=entry_data)
>       assert response.status_code == 201
E       assert 500 == 201
E        +  where 500 = <Response [500 Internal Server Error]>.status_code

tests/test_routes.py:38: AssertionError
---------------------------- Captured stdout setup -----------------------------
{"timestamp": "2025-02-11T01:56:28.201805", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Starting FastAPI server", "context": {}}
{"timestamp": "2025-02-11T01:56:28.202088", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection on startup", "context": {}}
{"timestamp": "2025-02-11T01:56:28.202417", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection and schema", "context": {}}
{"timestamp": "2025-02-11T01:56:28.264437", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database driver: psycopg2", "context": {}}
{"timestamp": "2025-02-11T01:56:28.264746", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database dialect: postgresql", "context": {}}
{"timestamp": "2025-02-11T01:56:28.264968", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Successfully connected to database", "context": {}}
{"timestamp": "2025-02-11T01:56:28.365868", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Found 5 tables in database", "context": {}}
{"timestamp": "2025-02-11T01:56:28.366250", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expected tables: time_entries, projects, customers, project_managers", "context": {}}
{"timestamp": "2025-02-11T01:56:28.492129", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table customers exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:28.571526", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table projects exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:28.651467", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table project_managers exists with 5 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:28.731299", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table time_entries exists with 12 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:28.731682", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database verification completed successfully", "context": {}}
{"timestamp": "2025-02-11T01:56:28.752586", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "=== CORS Configuration ===", "context": {}}
{"timestamp": "2025-02-11T01:56:28.753008", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Origins: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:28.753468", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "context": {}}
{"timestamp": "2025-02-11T01:56:28.753825", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allow Credentials: False", "context": {}}
{"timestamp": "2025-02-11T01:56:28.754057", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Headers: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:28.754342", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "context": {}}
------------------------------ Captured log setup ------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting FastAPI server", "timestamp": "2025-02-11T01:56:28.201925", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection on startup", "timestamp": "2025-02-11T01:56:28.202266", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection and schema", "timestamp": "2025-02-11T01:56:28.202488", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database driver: psycopg2", "timestamp": "2025-02-11T01:56:28.264567", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database dialect: postgresql", "timestamp": "2025-02-11T01:56:28.264822", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully connected to database", "timestamp": "2025-02-11T01:56:28.265035", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Found 5 tables in database", "timestamp": "2025-02-11T01:56:28.365997", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expected tables: time_entries, projects, customers, project_managers", "timestamp": "2025-02-11T01:56:28.366325", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table customers exists with 9 columns", "timestamp": "2025-02-11T01:56:28.492256", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table projects exists with 9 columns", "timestamp": "2025-02-11T01:56:28.571671", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table project_managers exists with 5 columns", "timestamp": "2025-02-11T01:56:28.651644", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table time_entries exists with 12 columns", "timestamp": "2025-02-11T01:56:28.731457", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database verification completed successfully", "timestamp": "2025-02-11T01:56:28.731814", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "=== CORS Configuration ===", "timestamp": "2025-02-11T01:56:28.752734", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Origins: '*'", "timestamp": "2025-02-11T01:56:28.753201", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "timestamp": "2025-02-11T01:56:28.753595", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allow Credentials: False", "timestamp": "2025-02-11T01:56:28.753912", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Headers: '*'", "timestamp": "2025-02-11T01:56:28.754166", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "timestamp": "2025-02-11T01:56:28.754448", "context": {}}
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:28.771748", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "202", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
{"timestamp": "2025-02-11T01:56:28.772629", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 307", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "1.01", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:28.773082", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
{"timestamp": "2025-02-11T01:56:28.774749", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "202", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
{"timestamp": "2025-02-11T01:56:28.781021", "level": "ERROR", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with exception", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "202", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:28.781643", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:28.771890", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "202", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 307", "timestamp": "2025-02-11T01:56:28.772749", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "1.01", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:28.773207", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:28.774847", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "202", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
ERROR    TimesheetTracker:logger.py:29 {"message": "Request failed with exception", "timestamp": "2025-02-11T01:56:28.781349", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "202", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:28.781778", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
--------------------------- Captured stdout teardown ---------------------------
{"timestamp": "2025-02-11T01:56:28.789332", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Shutting down FastAPI server", "context": {}}
---------------------------- Captured log teardown -----------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Shutting down FastAPI server", "timestamp": "2025-02-11T01:56:28.789455", "context": {}}
__________________ test_get_time_entries_with_database_query ___________________

client = <starlette.testclient.TestClient object at 0x7f34fb7d0dd0>
setup_test_data = {'customers': [<models.customerModel.Customer object at 0x7f34fb7d1150>, <models.customerModel.Customer object at 0x7f...project_id=Unassigned, name=Unassigned)>, <Project(id=2, project_id=Project_Magic_Bullet, name=Project Magic Bullet)>]}

    def test_get_time_entries_with_database_query(client, setup_test_data):
        """Test getting time entries with database query verification"""
        # Create multiple test entries first
        entries = [
            {
                "week_number": 41,
                "month": "October",
                "category": "Development",
                "subcategory": "Coding",
                "customer": "ECOLAB",
                "project": "Project_Magic_Bullet",
                "task_description": "Task 1",
                "hours": 8.0,
                "date": "2024-10-07"
            },
            {
                "week_number": 41,
                "month": "October",
                "category": "Development",
                "subcategory": "Testing",
                "customer": "ECOLAB",
                "project": "Project_Magic_Bullet",
                "task_description": "Task 2",
                "hours": 4.0,
                "date": "2024-10-07"
            }
        ]
    
        # Add entries to database
        for entry in entries:
            response = client.post("/time-entries/", json=entry)
>           assert response.status_code == 201
E           assert 500 == 201
E            +  where 500 = <Response [500 Internal Server Error]>.status_code

tests/test_routes.py:75: AssertionError
---------------------------- Captured stdout setup -----------------------------
{"timestamp": "2025-02-11T01:56:28.810503", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Starting FastAPI server", "context": {}}
{"timestamp": "2025-02-11T01:56:28.810716", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection on startup", "context": {}}
{"timestamp": "2025-02-11T01:56:28.810974", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection and schema", "context": {}}
{"timestamp": "2025-02-11T01:56:28.870454", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database driver: psycopg2", "context": {}}
{"timestamp": "2025-02-11T01:56:28.870853", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database dialect: postgresql", "context": {}}
{"timestamp": "2025-02-11T01:56:28.871255", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Successfully connected to database", "context": {}}
{"timestamp": "2025-02-11T01:56:28.975159", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Found 5 tables in database", "context": {}}
{"timestamp": "2025-02-11T01:56:28.975616", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expected tables: time_entries, projects, customers, project_managers", "context": {}}
{"timestamp": "2025-02-11T01:56:29.101961", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table customers exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:29.185225", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table projects exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:29.268535", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table project_managers exists with 5 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:29.352509", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table time_entries exists with 12 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:29.352845", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database verification completed successfully", "context": {}}
{"timestamp": "2025-02-11T01:56:29.372582", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "=== CORS Configuration ===", "context": {}}
{"timestamp": "2025-02-11T01:56:29.373009", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Origins: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:29.373437", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "context": {}}
{"timestamp": "2025-02-11T01:56:29.373704", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allow Credentials: False", "context": {}}
{"timestamp": "2025-02-11T01:56:29.373886", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Headers: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:29.374057", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "context": {}}
------------------------------ Captured log setup ------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting FastAPI server", "timestamp": "2025-02-11T01:56:28.810591", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection on startup", "timestamp": "2025-02-11T01:56:28.810830", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection and schema", "timestamp": "2025-02-11T01:56:28.811038", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database driver: psycopg2", "timestamp": "2025-02-11T01:56:28.870611", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database dialect: postgresql", "timestamp": "2025-02-11T01:56:28.870994", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully connected to database", "timestamp": "2025-02-11T01:56:28.871364", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Found 5 tables in database", "timestamp": "2025-02-11T01:56:28.975305", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expected tables: time_entries, projects, customers, project_managers", "timestamp": "2025-02-11T01:56:28.975749", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table customers exists with 9 columns", "timestamp": "2025-02-11T01:56:29.102106", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table projects exists with 9 columns", "timestamp": "2025-02-11T01:56:29.185330", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table project_managers exists with 5 columns", "timestamp": "2025-02-11T01:56:29.268641", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table time_entries exists with 12 columns", "timestamp": "2025-02-11T01:56:29.352640", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database verification completed successfully", "timestamp": "2025-02-11T01:56:29.352955", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "=== CORS Configuration ===", "timestamp": "2025-02-11T01:56:29.372732", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Origins: '*'", "timestamp": "2025-02-11T01:56:29.373140", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "timestamp": "2025-02-11T01:56:29.373570", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allow Credentials: False", "timestamp": "2025-02-11T01:56:29.373765", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Headers: '*'", "timestamp": "2025-02-11T01:56:29.373946", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "timestamp": "2025-02-11T01:56:29.374181", "context": {}}
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:29.394710", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "197", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
{"timestamp": "2025-02-11T01:56:29.395322", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 307", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "0.62", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:29.395662", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
{"timestamp": "2025-02-11T01:56:29.397141", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "197", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
{"timestamp": "2025-02-11T01:56:29.400663", "level": "ERROR", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with exception", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "197", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:29.401366", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:29.394819", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "197", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 307", "timestamp": "2025-02-11T01:56:29.395409", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "0.62", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:29.395732", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:29.397228", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "197", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
ERROR    TimesheetTracker:logger.py:29 {"message": "Request failed with exception", "timestamp": "2025-02-11T01:56:29.400994", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "197", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:29.401451", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
--------------------------- Captured stdout teardown ---------------------------
{"timestamp": "2025-02-11T01:56:29.410537", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Shutting down FastAPI server", "context": {}}
---------------------------- Captured log teardown -----------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Shutting down FastAPI server", "timestamp": "2025-02-11T01:56:29.410648", "context": {}}
___________________ test_get_time_entries_complex_filtering ____________________

client = <starlette.testclient.TestClient object at 0x7f34fb779110>
setup_test_data = {'customers': [<models.customerModel.Customer object at 0x7f34fb779810>, <models.customerModel.Customer object at 0x7f...project_id=Unassigned, name=Unassigned)>, <Project(id=2, project_id=Project_Magic_Bullet, name=Project Magic Bullet)>]}

    def test_get_time_entries_complex_filtering(client, setup_test_data):
        """Test time entries with multiple filter combinations"""
        # Create test entries with different combinations
        entries = [
            {
                "week_number": 41,
                "month": "October",
                "category": "Development",
                "subcategory": "Coding",
                "customer": "ECOLAB",
                "project": "Project_Magic_Bullet",
                "task_description": "Dev Task",
                "hours": 8.0,
                "date": "2024-10-07"
            },
            {
                "week_number": 41,
                "month": "October",
                "category": "QA",
                "subcategory": "Testing",
                "customer": "ECOLAB",
                "project": "Project_Magic_Bullet",
                "task_description": "QA Task",
                "hours": 4.0,
                "date": "2024-10-07"
            }
        ]
    
        for entry in entries:
            response = client.post("/time-entries/", json=entry)
>           assert response.status_code == 201
E           assert 500 == 201
E            +  where 500 = <Response [500 Internal Server Error]>.status_code

tests/test_routes.py:118: AssertionError
---------------------------- Captured stdout setup -----------------------------
{"timestamp": "2025-02-11T01:56:29.451994", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Starting FastAPI server", "context": {}}
{"timestamp": "2025-02-11T01:56:29.452497", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection on startup", "context": {}}
{"timestamp": "2025-02-11T01:56:29.452901", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection and schema", "context": {}}
{"timestamp": "2025-02-11T01:56:29.515313", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database driver: psycopg2", "context": {}}
{"timestamp": "2025-02-11T01:56:29.515608", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database dialect: postgresql", "context": {}}
{"timestamp": "2025-02-11T01:56:29.515850", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Successfully connected to database", "context": {}}
{"timestamp": "2025-02-11T01:56:29.615797", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Found 5 tables in database", "context": {}}
{"timestamp": "2025-02-11T01:56:29.616297", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expected tables: time_entries, projects, customers, project_managers", "context": {}}
{"timestamp": "2025-02-11T01:56:29.735995", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table customers exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:29.815512", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table projects exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:29.894891", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table project_managers exists with 5 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:29.974452", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table time_entries exists with 12 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:29.974756", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database verification completed successfully", "context": {}}
{"timestamp": "2025-02-11T01:56:29.995375", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "=== CORS Configuration ===", "context": {}}
{"timestamp": "2025-02-11T01:56:29.995612", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Origins: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:29.995819", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "context": {}}
{"timestamp": "2025-02-11T01:56:29.996046", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allow Credentials: False", "context": {}}
{"timestamp": "2025-02-11T01:56:29.996430", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Headers: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:29.996690", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "context": {}}
------------------------------ Captured log setup ------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting FastAPI server", "timestamp": "2025-02-11T01:56:29.452206", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection on startup", "timestamp": "2025-02-11T01:56:29.452720", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection and schema", "timestamp": "2025-02-11T01:56:29.452989", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database driver: psycopg2", "timestamp": "2025-02-11T01:56:29.515443", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database dialect: postgresql", "timestamp": "2025-02-11T01:56:29.515688", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully connected to database", "timestamp": "2025-02-11T01:56:29.515934", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Found 5 tables in database", "timestamp": "2025-02-11T01:56:29.615944", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expected tables: time_entries, projects, customers, project_managers", "timestamp": "2025-02-11T01:56:29.616385", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table customers exists with 9 columns", "timestamp": "2025-02-11T01:56:29.736178", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table projects exists with 9 columns", "timestamp": "2025-02-11T01:56:29.815624", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table project_managers exists with 5 columns", "timestamp": "2025-02-11T01:56:29.895011", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table time_entries exists with 12 columns", "timestamp": "2025-02-11T01:56:29.974570", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database verification completed successfully", "timestamp": "2025-02-11T01:56:29.974833", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "=== CORS Configuration ===", "timestamp": "2025-02-11T01:56:29.995466", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Origins: '*'", "timestamp": "2025-02-11T01:56:29.995682", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "timestamp": "2025-02-11T01:56:29.995899", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allow Credentials: False", "timestamp": "2025-02-11T01:56:29.996232", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Headers: '*'", "timestamp": "2025-02-11T01:56:29.996517", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "timestamp": "2025-02-11T01:56:29.996796", "context": {}}
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:30.022234", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
{"timestamp": "2025-02-11T01:56:30.022909", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 307", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "0.79", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:30.023362", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
{"timestamp": "2025-02-11T01:56:30.025536", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
{"timestamp": "2025-02-11T01:56:30.029100", "level": "ERROR", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with exception", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:30.029780", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:30.022379", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 307", "timestamp": "2025-02-11T01:56:30.023016", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "0.79", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:30.023448", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:30.025696", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
ERROR    TimesheetTracker:logger.py:29 {"message": "Request failed with exception", "timestamp": "2025-02-11T01:56:30.029423", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:30.029910", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
--------------------------- Captured stdout teardown ---------------------------
{"timestamp": "2025-02-11T01:56:30.037916", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Shutting down FastAPI server", "context": {}}
---------------------------- Captured log teardown -----------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Shutting down FastAPI server", "timestamp": "2025-02-11T01:56:30.038067", "context": {}}
____________________________ test_upload_csv_valid _____________________________

client = <starlette.testclient.TestClient object at 0x7f34fcb111d0>
setup_test_data = {'customers': [<models.customerModel.Customer object at 0x7f34fb77a610>, <models.customerModel.Customer object at 0x7f...project_id=Unassigned, name=Unassigned)>, <Project(id=2, project_id=Project_Magic_Bullet, name=Project Magic Bullet)>]}
tmp_path = PosixPath('/tmp/pytest-of-runner/pytest-2/test_upload_csv_valid0')

    def test_upload_csv_valid(client, setup_test_data, tmp_path):
        """Test uploading a valid CSV file"""
        csv_content = """Week Number,Month,Category,Subcategory,Customer,Project,Task Description,Hours,Date
    41,October,Other,Other Training,ECOLAB,Project_Magic_Bullet,Test task,8.0,2024-10-07
    41,October,Other,Other Training,ECOLAB,Project_Magic_Bullet,Another task,4.0,2024-10-07"""
    
        csv_file = tmp_path / "test.csv"
        csv_file.write_text(csv_content)
    
        with open(csv_file, "rb") as f:
            response = client.post(
                "/time-entries/upload/",
                files={"file": ("test.csv", f, "text/csv")}
            )
    
>       assert response.status_code == 201
E       assert 405 == 201
E        +  where 405 = <Response [405 Method Not Allowed]>.status_code

tests/test_routes.py:185: AssertionError
---------------------------- Captured stdout setup -----------------------------
{"timestamp": "2025-02-11T01:56:30.059846", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Starting FastAPI server", "context": {}}
{"timestamp": "2025-02-11T01:56:30.060042", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection on startup", "context": {}}
{"timestamp": "2025-02-11T01:56:30.060278", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection and schema", "context": {}}
{"timestamp": "2025-02-11T01:56:30.119453", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database driver: psycopg2", "context": {}}
{"timestamp": "2025-02-11T01:56:30.119905", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database dialect: postgresql", "context": {}}
{"timestamp": "2025-02-11T01:56:30.120250", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Successfully connected to database", "context": {}}
{"timestamp": "2025-02-11T01:56:30.224672", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Found 5 tables in database", "context": {}}
{"timestamp": "2025-02-11T01:56:30.225186", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expected tables: time_entries, projects, customers, project_managers", "context": {}}
{"timestamp": "2025-02-11T01:56:30.352502", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table customers exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:30.436351", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table projects exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:30.520412", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table project_managers exists with 5 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:30.604494", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table time_entries exists with 12 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:30.604878", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database verification completed successfully", "context": {}}
{"timestamp": "2025-02-11T01:56:30.624735", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "=== CORS Configuration ===", "context": {}}
{"timestamp": "2025-02-11T01:56:30.625084", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Origins: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:30.625420", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "context": {}}
{"timestamp": "2025-02-11T01:56:30.625653", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allow Credentials: False", "context": {}}
{"timestamp": "2025-02-11T01:56:30.625885", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Headers: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:30.626204", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "context": {}}
------------------------------ Captured log setup ------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting FastAPI server", "timestamp": "2025-02-11T01:56:30.059920", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection on startup", "timestamp": "2025-02-11T01:56:30.060099", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection and schema", "timestamp": "2025-02-11T01:56:30.060357", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database driver: psycopg2", "timestamp": "2025-02-11T01:56:30.119619", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database dialect: postgresql", "timestamp": "2025-02-11T01:56:30.120020", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully connected to database", "timestamp": "2025-02-11T01:56:30.120341", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Found 5 tables in database", "timestamp": "2025-02-11T01:56:30.224804", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expected tables: time_entries, projects, customers, project_managers", "timestamp": "2025-02-11T01:56:30.225296", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table customers exists with 9 columns", "timestamp": "2025-02-11T01:56:30.352634", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table projects exists with 9 columns", "timestamp": "2025-02-11T01:56:30.436478", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table project_managers exists with 5 columns", "timestamp": "2025-02-11T01:56:30.520633", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table time_entries exists with 12 columns", "timestamp": "2025-02-11T01:56:30.604620", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database verification completed successfully", "timestamp": "2025-02-11T01:56:30.604998", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "=== CORS Configuration ===", "timestamp": "2025-02-11T01:56:30.624893", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Origins: '*'", "timestamp": "2025-02-11T01:56:30.625267", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "timestamp": "2025-02-11T01:56:30.625515", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allow Credentials: False", "timestamp": "2025-02-11T01:56:30.625735", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Headers: '*'", "timestamp": "2025-02-11T01:56:30.625989", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "timestamp": "2025-02-11T01:56:30.626303", "context": {}}
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:30.669492", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "424", "content-type": "multipart/form-data; boundary=f3211a57a3aae0bc9f31786416e9c25e"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload/"}}
{"timestamp": "2025-02-11T01:56:30.671099", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 307", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/upload/", "process_time_ms": "1.63", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries/upload"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/upload/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:30.671874", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload/", "status_code": 307}}
{"timestamp": "2025-02-11T01:56:30.673848", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "424", "content-type": "multipart/form-data; boundary=f3211a57a3aae0bc9f31786416e9c25e"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload"}}
{"timestamp": "2025-02-11T01:56:30.674577", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 405", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 405, "method": "POST", "url": "http://testserver/time-entries/upload", "process_time_ms": "0.80", "response_headers": {"allow": "PUT", "content-length": "31", "content-type": "application/json"}, "error_detail": null, "query_params": {}, "path_params": {"entry_id": "upload"}, "client_host": "testclient", "path": "/time-entries/upload", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:30.675097", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload", "status_code": 405}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:30.669756", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "424", "content-type": "multipart/form-data; boundary=f3211a57a3aae0bc9f31786416e9c25e"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 307", "timestamp": "2025-02-11T01:56:30.671368", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/upload/", "process_time_ms": "1.63", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries/upload"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/upload/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:30.671987", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload/", "status_code": 307}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:30.673956", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "424", "content-type": "multipart/form-data; boundary=f3211a57a3aae0bc9f31786416e9c25e"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 405", "timestamp": "2025-02-11T01:56:30.674761", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 405, "method": "POST", "url": "http://testserver/time-entries/upload", "process_time_ms": "0.80", "response_headers": {"allow": "PUT", "content-length": "31", "content-type": "application/json"}, "error_detail": null, "query_params": {}, "path_params": {"entry_id": "upload"}, "client_host": "testclient", "path": "/time-entries/upload", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:30.675197", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload", "status_code": 405}}
--------------------------- Captured stdout teardown ---------------------------
{"timestamp": "2025-02-11T01:56:30.686336", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Shutting down FastAPI server", "context": {}}
---------------------------- Captured log teardown -----------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Shutting down FastAPI server", "timestamp": "2025-02-11T01:56:30.686457", "context": {}}
________________________ test_upload_csv_invalid_format ________________________

client = <starlette.testclient.TestClient object at 0x7f34fb7bbf10>

    def test_upload_csv_invalid_format(client):
        """Test uploading CSV with invalid format"""
        # Create CSV with missing required columns
        csv_content = "Category,Hours\nOther,8.0"
        csv_file = io.StringIO(csv_content)
    
>       response = client.post(
            "/time-entries/upload/",
            files={"file": ("test.csv", csv_file, "text/csv")}
        )

tests/test_routes.py:196: 
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 
.pythonlibs/lib/python3.11/site-packages/starlette/testclient.py:593: in post
    return super().post(
.pythonlibs/lib/python3.11/site-packages/httpx/_client.py:1144: in post
    return self.request(
.pythonlibs/lib/python3.11/site-packages/starlette/testclient.py:484: in request
    return super().request(
.pythonlibs/lib/python3.11/site-packages/httpx/_client.py:812: in request
    request = self.build_request(
.pythonlibs/lib/python3.11/site-packages/httpx/_client.py:378: in build_request
    return Request(
.pythonlibs/lib/python3.11/site-packages/httpx/_models.py:408: in __init__
    headers, stream = encode_request(
.pythonlibs/lib/python3.11/site-packages/httpx/_content.py:212: in encode_request
    return encode_multipart_data(data or {}, files, boundary)
.pythonlibs/lib/python3.11/site-packages/httpx/_content.py:155: in encode_multipart_data
    multipart = MultipartStream(data=data, files=files, boundary=boundary)
.pythonlibs/lib/python3.11/site-packages/httpx/_multipart.py:242: in __init__
    self.fields = list(self._iter_fields(data, files))
.pythonlibs/lib/python3.11/site-packages/httpx/_multipart.py:256: in _iter_fields
    yield FileField(name=name, value=value)
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ 

self = <httpx._multipart.FileField object at 0x7f34fb64ac90>, name = 'file'
value = ('test.csv', <_io.StringIO object at 0x7f34fb72c550>, 'text/csv')

    def __init__(self, name: str, value: FileTypes) -> None:
        self.name = name
    
        fileobj: FileContent
    
        headers: dict[str, str] = {}
        content_type: str | None = None
    
        # This large tuple based API largely mirror's requests' API
        # It would be good to think of better APIs for this that we could
        # include in httpx 2.0 since variable length tuples(especially of 4 elements)
        # are quite unwieldly
        if isinstance(value, tuple):
            if len(value) == 2:
                # neither the 3rd parameter (content_type) nor the 4th (headers)
                # was included
                filename, fileobj = value
            elif len(value) == 3:
                filename, fileobj, content_type = value
            else:
                # all 4 parameters included
                filename, fileobj, content_type, headers = value  # type: ignore
        else:
            filename = Path(str(getattr(value, "name", "upload"))).name
            fileobj = value
    
        if content_type is None:
            content_type = _guess_content_type(filename)
    
        has_content_type_header = any("content-type" in key.lower() for key in headers)
        if content_type is not None and not has_content_type_header:
            # note that unlike requests, we ignore the content_type provided in the 3rd
            # tuple element if it is also included in the headers requests does
            # the opposite (it overwrites the headerwith the 3rd tuple element)
            headers["Content-Type"] = content_type
    
        if isinstance(fileobj, io.StringIO):
>           raise TypeError(
                "Multipart file uploads require 'io.BytesIO', not 'io.StringIO'."
            )
E           TypeError: Multipart file uploads require 'io.BytesIO', not 'io.StringIO'.

.pythonlibs/lib/python3.11/site-packages/httpx/_multipart.py:159: TypeError
---------------------------- Captured stdout setup -----------------------------
{"timestamp": "2025-02-11T01:56:30.730698", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Starting FastAPI server", "context": {}}
{"timestamp": "2025-02-11T01:56:30.731052", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection on startup", "context": {}}
{"timestamp": "2025-02-11T01:56:30.731532", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection and schema", "context": {}}
{"timestamp": "2025-02-11T01:56:30.793757", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database driver: psycopg2", "context": {}}
{"timestamp": "2025-02-11T01:56:30.794160", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database dialect: postgresql", "context": {}}
{"timestamp": "2025-02-11T01:56:30.794451", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Successfully connected to database", "context": {}}
{"timestamp": "2025-02-11T01:56:30.895244", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Found 5 tables in database", "context": {}}
{"timestamp": "2025-02-11T01:56:30.895690", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expected tables: time_entries, projects, customers, project_managers", "context": {}}
{"timestamp": "2025-02-11T01:56:31.015280", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table customers exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:31.094741", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table projects exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:31.174069", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table project_managers exists with 5 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:31.254014", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table time_entries exists with 12 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:31.254492", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database verification completed successfully", "context": {}}
{"timestamp": "2025-02-11T01:56:31.275414", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "=== CORS Configuration ===", "context": {}}
{"timestamp": "2025-02-11T01:56:31.275809", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Origins: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:31.276291", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "context": {}}
{"timestamp": "2025-02-11T01:56:31.276618", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allow Credentials: False", "context": {}}
{"timestamp": "2025-02-11T01:56:31.276909", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Headers: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:31.277211", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "context": {}}
------------------------------ Captured log setup ------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting FastAPI server", "timestamp": "2025-02-11T01:56:30.730869", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection on startup", "timestamp": "2025-02-11T01:56:30.731250", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection and schema", "timestamp": "2025-02-11T01:56:30.731621", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database driver: psycopg2", "timestamp": "2025-02-11T01:56:30.793910", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database dialect: postgresql", "timestamp": "2025-02-11T01:56:30.794260", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully connected to database", "timestamp": "2025-02-11T01:56:30.794539", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Found 5 tables in database", "timestamp": "2025-02-11T01:56:30.895413", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expected tables: time_entries, projects, customers, project_managers", "timestamp": "2025-02-11T01:56:30.895890", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table customers exists with 9 columns", "timestamp": "2025-02-11T01:56:31.015396", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table projects exists with 9 columns", "timestamp": "2025-02-11T01:56:31.094884", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table project_managers exists with 5 columns", "timestamp": "2025-02-11T01:56:31.174301", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table time_entries exists with 12 columns", "timestamp": "2025-02-11T01:56:31.254205", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database verification completed successfully", "timestamp": "2025-02-11T01:56:31.254618", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "=== CORS Configuration ===", "timestamp": "2025-02-11T01:56:31.275550", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Origins: '*'", "timestamp": "2025-02-11T01:56:31.275975", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "timestamp": "2025-02-11T01:56:31.276425", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allow Credentials: False", "timestamp": "2025-02-11T01:56:31.276720", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Headers: '*'", "timestamp": "2025-02-11T01:56:31.277003", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "timestamp": "2025-02-11T01:56:31.277311", "context": {}}
--------------------------- Captured stdout teardown ---------------------------
{"timestamp": "2025-02-11T01:56:31.419549", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Shutting down FastAPI server", "context": {}}
---------------------------- Captured log teardown -----------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Shutting down FastAPI server", "timestamp": "2025-02-11T01:56:31.419664", "context": {}}
____________________ test_upload_csv_with_validation_errors ____________________

client = <starlette.testclient.TestClient object at 0x7f34fb5afa90>
setup_test_data = {'customers': [<models.customerModel.Customer object at 0x7f34fcbfa2d0>, <models.customerModel.Customer object at 0x7f...project_id=Unassigned, name=Unassigned)>, <Project(id=2, project_id=Project_Magic_Bullet, name=Project Magic Bullet)>]}
tmp_path = PosixPath('/tmp/pytest-of-runner/pytest-2/test_upload_csv_with_validatio0')

    def test_upload_csv_with_validation_errors(client, setup_test_data, tmp_path):
        """Test uploading CSV with entries that will produce validation warnings"""
        csv_content = """Week Number,Month,Category,Subcategory,Customer,Project,Task Description,Hours,Date
    41,October,Other,Other Training,NonExistent,NonExistent,Test task,8.0,2024-10-07"""
    
        csv_file = tmp_path / "test.csv"
        csv_file.write_text(csv_content)
    
        with open(csv_file, "rb") as f:
            response = client.post(
                "/time-entries/upload/",
                files={"file": ("test.csv", f, "text/csv")}
            )
    
>       assert response.status_code == 201
E       assert 405 == 201
E        +  where 405 = <Response [405 Method Not Allowed]>.status_code

tests/test_routes.py:218: AssertionError
---------------------------- Captured stdout setup -----------------------------
{"timestamp": "2025-02-11T01:56:31.796011", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Starting FastAPI server", "context": {}}
{"timestamp": "2025-02-11T01:56:31.796374", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection on startup", "context": {}}
{"timestamp": "2025-02-11T01:56:31.796915", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection and schema", "context": {}}
{"timestamp": "2025-02-11T01:56:31.856217", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database driver: psycopg2", "context": {}}
{"timestamp": "2025-02-11T01:56:31.856623", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database dialect: postgresql", "context": {}}
{"timestamp": "2025-02-11T01:56:31.856900", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Successfully connected to database", "context": {}}
{"timestamp": "2025-02-11T01:56:31.961037", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Found 5 tables in database", "context": {}}
{"timestamp": "2025-02-11T01:56:31.961559", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expected tables: time_entries, projects, customers, project_managers", "context": {}}
{"timestamp": "2025-02-11T01:56:32.088037", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table customers exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:32.172459", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table projects exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:32.256701", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table project_managers exists with 5 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:32.340624", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table time_entries exists with 12 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:32.340997", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database verification completed successfully", "context": {}}
{"timestamp": "2025-02-11T01:56:32.361563", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "=== CORS Configuration ===", "context": {}}
{"timestamp": "2025-02-11T01:56:32.362441", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Origins: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:32.362696", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "context": {}}
{"timestamp": "2025-02-11T01:56:32.362910", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allow Credentials: False", "context": {}}
{"timestamp": "2025-02-11T01:56:32.363103", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Headers: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:32.363369", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "context": {}}
------------------------------ Captured log setup ------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting FastAPI server", "timestamp": "2025-02-11T01:56:31.796175", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection on startup", "timestamp": "2025-02-11T01:56:31.796488", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection and schema", "timestamp": "2025-02-11T01:56:31.797016", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database driver: psycopg2", "timestamp": "2025-02-11T01:56:31.856410", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database dialect: postgresql", "timestamp": "2025-02-11T01:56:31.856720", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully connected to database", "timestamp": "2025-02-11T01:56:31.856987", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Found 5 tables in database", "timestamp": "2025-02-11T01:56:31.961206", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expected tables: time_entries, projects, customers, project_managers", "timestamp": "2025-02-11T01:56:31.961702", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table customers exists with 9 columns", "timestamp": "2025-02-11T01:56:32.088176", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table projects exists with 9 columns", "timestamp": "2025-02-11T01:56:32.172596", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table project_managers exists with 5 columns", "timestamp": "2025-02-11T01:56:32.256873", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table time_entries exists with 12 columns", "timestamp": "2025-02-11T01:56:32.340820", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database verification completed successfully", "timestamp": "2025-02-11T01:56:32.341067", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "=== CORS Configuration ===", "timestamp": "2025-02-11T01:56:32.361745", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Origins: '*'", "timestamp": "2025-02-11T01:56:32.362545", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "timestamp": "2025-02-11T01:56:32.362762", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allow Credentials: False", "timestamp": "2025-02-11T01:56:32.362966", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Headers: '*'", "timestamp": "2025-02-11T01:56:32.363197", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "timestamp": "2025-02-11T01:56:32.363445", "context": {}}
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:32.387341", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "332", "content-type": "multipart/form-data; boundary=2ab4d69de55f72e4f91de2f920aa0287"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload/"}}
{"timestamp": "2025-02-11T01:56:32.388238", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 307", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/upload/", "process_time_ms": "1.09", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries/upload"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/upload/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:32.388808", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload/", "status_code": 307}}
{"timestamp": "2025-02-11T01:56:32.390719", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "332", "content-type": "multipart/form-data; boundary=2ab4d69de55f72e4f91de2f920aa0287"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload"}}
{"timestamp": "2025-02-11T01:56:32.391421", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 405", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 405, "method": "POST", "url": "http://testserver/time-entries/upload", "process_time_ms": "0.74", "response_headers": {"allow": "PUT", "content-length": "31", "content-type": "application/json"}, "error_detail": null, "query_params": {}, "path_params": {"entry_id": "upload"}, "client_host": "testclient", "path": "/time-entries/upload", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:32.391848", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload", "status_code": 405}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:32.387558", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "332", "content-type": "multipart/form-data; boundary=2ab4d69de55f72e4f91de2f920aa0287"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 307", "timestamp": "2025-02-11T01:56:32.388372", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/upload/", "process_time_ms": "1.09", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries/upload"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/upload/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:32.388904", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload/", "status_code": 307}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:32.390880", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "332", "content-type": "multipart/form-data; boundary=2ab4d69de55f72e4f91de2f920aa0287"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 405", "timestamp": "2025-02-11T01:56:32.391550", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 405, "method": "POST", "url": "http://testserver/time-entries/upload", "process_time_ms": "0.74", "response_headers": {"allow": "PUT", "content-length": "31", "content-type": "application/json"}, "error_detail": null, "query_params": {}, "path_params": {"entry_id": "upload"}, "client_host": "testclient", "path": "/time-entries/upload", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:32.391973", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload", "status_code": 405}}
--------------------------- Captured stdout teardown ---------------------------
{"timestamp": "2025-02-11T01:56:32.399777", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Shutting down FastAPI server", "context": {}}
---------------------------- Captured log teardown -----------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Shutting down FastAPI server", "timestamp": "2025-02-11T01:56:32.399881", "context": {}}
__________________ test_upload_csv_with_foreign_key_violation __________________

client = <starlette.testclient.TestClient object at 0x7f34fcbf8250>
setup_test_data = {'customers': [<models.customerModel.Customer object at 0x7f34fb7502d0>, <models.customerModel.Customer object at 0x7f...project_id=Unassigned, name=Unassigned)>, <Project(id=2, project_id=Project_Magic_Bullet, name=Project Magic Bullet)>]}
tmp_path = PosixPath('/tmp/pytest-of-runner/pytest-2/test_upload_csv_with_foreign_k0')

    def test_upload_csv_with_foreign_key_violation(client, setup_test_data, tmp_path):
        """Test handling of foreign key violations during CSV upload"""
        csv_content = """Week Number,Month,Category,Subcategory,Customer,Project,Task Description,Hours,Date
    41,October,Other,Other Training,Project Magic Bullet,NonExistent,Test task,8.0,2024-10-07"""
    
        csv_file = tmp_path / "test.csv"
        csv_file.write_text(csv_content)
    
        with open(csv_file, "rb") as f:
            response = client.post(
                "/time-entries/upload/",
                files={"file": ("test.csv", f, "text/csv")}
            )
    
>       assert response.status_code == 201  # Should succeed with validation warnings
E       assert 405 == 201
E        +  where 405 = <Response [405 Method Not Allowed]>.status_code

tests/test_routes.py:238: AssertionError
---------------------------- Captured stdout setup -----------------------------
{"timestamp": "2025-02-11T01:56:32.432877", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Starting FastAPI server", "context": {}}
{"timestamp": "2025-02-11T01:56:32.433239", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection on startup", "context": {}}
{"timestamp": "2025-02-11T01:56:32.433498", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection and schema", "context": {}}
{"timestamp": "2025-02-11T01:56:32.495599", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database driver: psycopg2", "context": {}}
{"timestamp": "2025-02-11T01:56:32.495921", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database dialect: postgresql", "context": {}}
{"timestamp": "2025-02-11T01:56:32.496254", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Successfully connected to database", "context": {}}
{"timestamp": "2025-02-11T01:56:32.595444", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Found 5 tables in database", "context": {}}
{"timestamp": "2025-02-11T01:56:32.596010", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expected tables: time_entries, projects, customers, project_managers", "context": {}}
{"timestamp": "2025-02-11T01:56:32.718761", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table customers exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:32.799510", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table projects exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:32.879572", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table project_managers exists with 5 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:32.959509", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table time_entries exists with 12 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:32.959915", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database verification completed successfully", "context": {}}
{"timestamp": "2025-02-11T01:56:32.980782", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "=== CORS Configuration ===", "context": {}}
{"timestamp": "2025-02-11T01:56:32.981398", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Origins: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:32.981680", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "context": {}}
{"timestamp": "2025-02-11T01:56:32.981946", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allow Credentials: False", "context": {}}
{"timestamp": "2025-02-11T01:56:32.982230", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Headers: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:32.982500", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "context": {}}
------------------------------ Captured log setup ------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting FastAPI server", "timestamp": "2025-02-11T01:56:32.433024", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection on startup", "timestamp": "2025-02-11T01:56:32.433323", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection and schema", "timestamp": "2025-02-11T01:56:32.433583", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database driver: psycopg2", "timestamp": "2025-02-11T01:56:32.495736", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database dialect: postgresql", "timestamp": "2025-02-11T01:56:32.496011", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully connected to database", "timestamp": "2025-02-11T01:56:32.496337", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Found 5 tables in database", "timestamp": "2025-02-11T01:56:32.595588", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expected tables: time_entries, projects, customers, project_managers", "timestamp": "2025-02-11T01:56:32.596136", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table customers exists with 9 columns", "timestamp": "2025-02-11T01:56:32.718901", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table projects exists with 9 columns", "timestamp": "2025-02-11T01:56:32.799630", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table project_managers exists with 5 columns", "timestamp": "2025-02-11T01:56:32.879841", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table time_entries exists with 12 columns", "timestamp": "2025-02-11T01:56:32.959667", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database verification completed successfully", "timestamp": "2025-02-11T01:56:32.960019", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "=== CORS Configuration ===", "timestamp": "2025-02-11T01:56:32.980953", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Origins: '*'", "timestamp": "2025-02-11T01:56:32.981504", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "timestamp": "2025-02-11T01:56:32.981777", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allow Credentials: False", "timestamp": "2025-02-11T01:56:32.982035", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Headers: '*'", "timestamp": "2025-02-11T01:56:32.982318", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "timestamp": "2025-02-11T01:56:32.982594", "context": {}}
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:33.017786", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "341", "content-type": "multipart/form-data; boundary=709857f1faac314546e7a29cb3e89f2b"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload/"}}
{"timestamp": "2025-02-11T01:56:33.018692", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 307", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/upload/", "process_time_ms": "1.07", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries/upload"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/upload/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:33.019199", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload/", "status_code": 307}}
{"timestamp": "2025-02-11T01:56:33.021084", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "341", "content-type": "multipart/form-data; boundary=709857f1faac314546e7a29cb3e89f2b"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload"}}
{"timestamp": "2025-02-11T01:56:33.022255", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 405", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 405, "method": "POST", "url": "http://testserver/time-entries/upload", "process_time_ms": "0.99", "response_headers": {"allow": "PUT", "content-length": "31", "content-type": "application/json"}, "error_detail": null, "query_params": {}, "path_params": {"entry_id": "upload"}, "client_host": "testclient", "path": "/time-entries/upload", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:33.022679", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload", "status_code": 405}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:33.017990", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "341", "content-type": "multipart/form-data; boundary=709857f1faac314546e7a29cb3e89f2b"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 307", "timestamp": "2025-02-11T01:56:33.018824", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/upload/", "process_time_ms": "1.07", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries/upload"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/upload/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:33.019306", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload/", "status_code": 307}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:33.021332", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "341", "content-type": "multipart/form-data; boundary=709857f1faac314546e7a29cb3e89f2b"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 405", "timestamp": "2025-02-11T01:56:33.022388", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 405, "method": "POST", "url": "http://testserver/time-entries/upload", "process_time_ms": "0.99", "response_headers": {"allow": "PUT", "content-length": "31", "content-type": "application/json"}, "error_detail": null, "query_params": {}, "path_params": {"entry_id": "upload"}, "client_host": "testclient", "path": "/time-entries/upload", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:33.022778", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload", "status_code": 405}}
--------------------------- Captured stdout teardown ---------------------------
{"timestamp": "2025-02-11T01:56:33.031885", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Shutting down FastAPI server", "context": {}}
---------------------------- Captured log teardown -----------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Shutting down FastAPI server", "timestamp": "2025-02-11T01:56:33.031991", "context": {}}
_______________ test_upload_csv_with_mismatched_customer_project _______________

client = <starlette.testclient.TestClient object at 0x7f351c11ed90>
setup_test_data = {'customers': [<models.customerModel.Customer object at 0x7f34fb663710>, <models.customerModel.Customer object at 0x7f...project_id=Unassigned, name=Unassigned)>, <Project(id=2, project_id=Project_Magic_Bullet, name=Project Magic Bullet)>]}
tmp_path = PosixPath('/tmp/pytest-of-runner/pytest-2/test_upload_csv_with_mismatche0')

    def test_upload_csv_with_mismatched_customer_project(client, setup_test_data, tmp_path):
        """Test uploading CSV with mismatched customer-project relationships"""
        csv_content = """Week Number,Month,Category,Subcategory,Customer,Project,Task Description,Hours,Date
    41,October,Other,Other Training,ECOLAB,NonExistent_Project,Test task,8.0,2024-10-07"""
    
        csv_file = tmp_path / "test.csv"
        csv_file.write_text(csv_content)
    
        with open(csv_file, "rb") as f:
            response = client.post(
                "/time-entries/upload/",
                files={"file": ("test.csv", f, "text/csv")}
            )
    
>       assert response.status_code == 201
E       assert 405 == 201
E        +  where 405 = <Response [405 Method Not Allowed]>.status_code

tests/test_routes.py:265: AssertionError
---------------------------- Captured stdout setup -----------------------------
{"timestamp": "2025-02-11T01:56:33.061856", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Starting FastAPI server", "context": {}}
{"timestamp": "2025-02-11T01:56:33.062275", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection on startup", "context": {}}
{"timestamp": "2025-02-11T01:56:33.062563", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection and schema", "context": {}}
{"timestamp": "2025-02-11T01:56:33.121511", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database driver: psycopg2", "context": {}}
{"timestamp": "2025-02-11T01:56:33.121984", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database dialect: postgresql", "context": {}}
{"timestamp": "2025-02-11T01:56:33.122311", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Successfully connected to database", "context": {}}
{"timestamp": "2025-02-11T01:56:33.226566", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Found 5 tables in database", "context": {}}
{"timestamp": "2025-02-11T01:56:33.226977", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expected tables: time_entries, projects, customers, project_managers", "context": {}}
{"timestamp": "2025-02-11T01:56:33.354825", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table customers exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:33.438980", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table projects exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:33.522840", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table project_managers exists with 5 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:33.607200", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table time_entries exists with 12 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:33.607555", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database verification completed successfully", "context": {}}
{"timestamp": "2025-02-11T01:56:33.627652", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "=== CORS Configuration ===", "context": {}}
{"timestamp": "2025-02-11T01:56:33.627961", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Origins: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:33.628261", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "context": {}}
{"timestamp": "2025-02-11T01:56:33.628502", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allow Credentials: False", "context": {}}
{"timestamp": "2025-02-11T01:56:33.628824", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Headers: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:33.629137", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "context": {}}
------------------------------ Captured log setup ------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting FastAPI server", "timestamp": "2025-02-11T01:56:33.061987", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection on startup", "timestamp": "2025-02-11T01:56:33.062410", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection and schema", "timestamp": "2025-02-11T01:56:33.062644", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database driver: psycopg2", "timestamp": "2025-02-11T01:56:33.121694", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database dialect: postgresql", "timestamp": "2025-02-11T01:56:33.122102", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully connected to database", "timestamp": "2025-02-11T01:56:33.122409", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Found 5 tables in database", "timestamp": "2025-02-11T01:56:33.226713", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expected tables: time_entries, projects, customers, project_managers", "timestamp": "2025-02-11T01:56:33.227058", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table customers exists with 9 columns", "timestamp": "2025-02-11T01:56:33.354971", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table projects exists with 9 columns", "timestamp": "2025-02-11T01:56:33.439155", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table project_managers exists with 5 columns", "timestamp": "2025-02-11T01:56:33.522981", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table time_entries exists with 12 columns", "timestamp": "2025-02-11T01:56:33.607329", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database verification completed successfully", "timestamp": "2025-02-11T01:56:33.607658", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "=== CORS Configuration ===", "timestamp": "2025-02-11T01:56:33.627769", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Origins: '*'", "timestamp": "2025-02-11T01:56:33.628063", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "timestamp": "2025-02-11T01:56:33.628343", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allow Credentials: False", "timestamp": "2025-02-11T01:56:33.628580", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Headers: '*'", "timestamp": "2025-02-11T01:56:33.628923", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "timestamp": "2025-02-11T01:56:33.629218", "context": {}}
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:33.698944", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "335", "content-type": "multipart/form-data; boundary=65e1c192c4dcab548e86e43fad5653a2"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload/"}}
{"timestamp": "2025-02-11T01:56:33.699704", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 307", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/upload/", "process_time_ms": "0.90", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries/upload"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/upload/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:33.700210", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload/", "status_code": 307}}
{"timestamp": "2025-02-11T01:56:33.701802", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "335", "content-type": "multipart/form-data; boundary=65e1c192c4dcab548e86e43fad5653a2"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload"}}
{"timestamp": "2025-02-11T01:56:33.702611", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 405", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 405, "method": "POST", "url": "http://testserver/time-entries/upload", "process_time_ms": "0.85", "response_headers": {"allow": "PUT", "content-length": "31", "content-type": "application/json"}, "error_detail": null, "query_params": {}, "path_params": {"entry_id": "upload"}, "client_host": "testclient", "path": "/time-entries/upload", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:33.703098", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload", "status_code": 405}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:33.699123", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "335", "content-type": "multipart/form-data; boundary=65e1c192c4dcab548e86e43fad5653a2"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 307", "timestamp": "2025-02-11T01:56:33.699828", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/upload/", "process_time_ms": "0.90", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries/upload"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/upload/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:33.700296", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload/", "status_code": 307}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:33.701962", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "335", "content-type": "multipart/form-data; boundary=65e1c192c4dcab548e86e43fad5653a2"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 405", "timestamp": "2025-02-11T01:56:33.702785", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 405, "method": "POST", "url": "http://testserver/time-entries/upload", "process_time_ms": "0.85", "response_headers": {"allow": "PUT", "content-length": "31", "content-type": "application/json"}, "error_detail": null, "query_params": {}, "path_params": {"entry_id": "upload"}, "client_host": "testclient", "path": "/time-entries/upload", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:33.703254", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload", "status_code": 405}}
--------------------------- Captured stdout teardown ---------------------------
{"timestamp": "2025-02-11T01:56:33.713458", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Shutting down FastAPI server", "context": {}}
---------------------------- Captured log teardown -----------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Shutting down FastAPI server", "timestamp": "2025-02-11T01:56:33.713580", "context": {}}
_______________ test_upload_csv_with_multiple_validation_errors ________________

client = <starlette.testclient.TestClient object at 0x7f34fd32bb50>
setup_test_data = {'customers': [<models.customerModel.Customer object at 0x7f34fcb09ad0>, <models.customerModel.Customer object at 0x7f...project_id=Unassigned, name=Unassigned)>, <Project(id=2, project_id=Project_Magic_Bullet, name=Project Magic Bullet)>]}
tmp_path = PosixPath('/tmp/pytest-of-runner/pytest-2/test_upload_csv_with_multiple_0')

    def test_upload_csv_with_multiple_validation_errors(client, setup_test_data, tmp_path):
        """Test uploading CSV with multiple types of validation errors"""
        csv_content = """Week Number,Month,Category,Subcategory,Customer,Project,Task Description,Hours,Date
    41,October,Other,Other Training,Invalid1,Project1,Task 1,8.0,2024-10-07
    41,October,Other,Other Training,ECOLAB,Invalid2,Task 2,8.0,2024-10-07
    41,October,Other,Other Training,Invalid3,Project3,Task 3,25.0,2024-10-07"""
    
        csv_file = tmp_path / "test.csv"
        csv_file.write_text(csv_content)
    
        with open(csv_file, "rb") as f:
            response = client.post(
                "/time-entries/upload/",
                files={"file": ("test.csv", f, "text/csv")}
            )
    
>       assert response.status_code == 201
E       assert 405 == 201
E        +  where 405 = <Response [405 Method Not Allowed]>.status_code

tests/test_routes.py:293: AssertionError
---------------------------- Captured stdout setup -----------------------------
{"timestamp": "2025-02-11T01:56:33.768664", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Starting FastAPI server", "context": {}}
{"timestamp": "2025-02-11T01:56:33.769241", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection on startup", "context": {}}
{"timestamp": "2025-02-11T01:56:33.769615", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection and schema", "context": {}}
{"timestamp": "2025-02-11T01:56:33.833736", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database driver: psycopg2", "context": {}}
{"timestamp": "2025-02-11T01:56:33.834330", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database dialect: postgresql", "context": {}}
{"timestamp": "2025-02-11T01:56:33.834617", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Successfully connected to database", "context": {}}
{"timestamp": "2025-02-11T01:56:33.933753", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Found 5 tables in database", "context": {}}
{"timestamp": "2025-02-11T01:56:33.934314", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expected tables: time_entries, projects, customers, project_managers", "context": {}}
{"timestamp": "2025-02-11T01:56:34.057363", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table customers exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:34.139933", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table projects exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:34.220002", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table project_managers exists with 5 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:34.299838", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table time_entries exists with 12 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:34.300199", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database verification completed successfully", "context": {}}
{"timestamp": "2025-02-11T01:56:34.321333", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "=== CORS Configuration ===", "context": {}}
{"timestamp": "2025-02-11T01:56:34.321611", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Origins: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:34.321833", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "context": {}}
{"timestamp": "2025-02-11T01:56:34.322120", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allow Credentials: False", "context": {}}
{"timestamp": "2025-02-11T01:56:34.322324", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Headers: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:34.322571", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "context": {}}
------------------------------ Captured log setup ------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting FastAPI server", "timestamp": "2025-02-11T01:56:33.768845", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection on startup", "timestamp": "2025-02-11T01:56:33.769380", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection and schema", "timestamp": "2025-02-11T01:56:33.769816", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database driver: psycopg2", "timestamp": "2025-02-11T01:56:33.833873", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database dialect: postgresql", "timestamp": "2025-02-11T01:56:33.834443", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully connected to database", "timestamp": "2025-02-11T01:56:33.834714", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Found 5 tables in database", "timestamp": "2025-02-11T01:56:33.933929", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expected tables: time_entries, projects, customers, project_managers", "timestamp": "2025-02-11T01:56:33.934391", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table customers exists with 9 columns", "timestamp": "2025-02-11T01:56:34.057559", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table projects exists with 9 columns", "timestamp": "2025-02-11T01:56:34.140063", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table project_managers exists with 5 columns", "timestamp": "2025-02-11T01:56:34.220202", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table time_entries exists with 12 columns", "timestamp": "2025-02-11T01:56:34.299950", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database verification completed successfully", "timestamp": "2025-02-11T01:56:34.300271", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "=== CORS Configuration ===", "timestamp": "2025-02-11T01:56:34.321439", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Origins: '*'", "timestamp": "2025-02-11T01:56:34.321687", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "timestamp": "2025-02-11T01:56:34.321913", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allow Credentials: False", "timestamp": "2025-02-11T01:56:34.322187", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Headers: '*'", "timestamp": "2025-02-11T01:56:34.322407", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "timestamp": "2025-02-11T01:56:34.322650", "context": {}}
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:34.348802", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "466", "content-type": "multipart/form-data; boundary=1ddb741d6bcd18a1c4c23798b3629625"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload/"}}
{"timestamp": "2025-02-11T01:56:34.349707", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 307", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/upload/", "process_time_ms": "0.97", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries/upload"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/upload/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:34.350223", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload/", "status_code": 307}}
{"timestamp": "2025-02-11T01:56:34.352041", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "466", "content-type": "multipart/form-data; boundary=1ddb741d6bcd18a1c4c23798b3629625"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload"}}
{"timestamp": "2025-02-11T01:56:34.352811", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 405", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 405, "method": "POST", "url": "http://testserver/time-entries/upload", "process_time_ms": "0.77", "response_headers": {"allow": "PUT", "content-length": "31", "content-type": "application/json"}, "error_detail": null, "query_params": {}, "path_params": {"entry_id": "upload"}, "client_host": "testclient", "path": "/time-entries/upload", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:34.353401", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload", "status_code": 405}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:34.348943", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "466", "content-type": "multipart/form-data; boundary=1ddb741d6bcd18a1c4c23798b3629625"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 307", "timestamp": "2025-02-11T01:56:34.349812", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/upload/", "process_time_ms": "0.97", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries/upload"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/upload/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:34.350314", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload/", "status_code": 307}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:34.352190", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/upload", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "466", "content-type": "multipart/form-data; boundary=1ddb741d6bcd18a1c4c23798b3629625"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/upload"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 405", "timestamp": "2025-02-11T01:56:34.352963", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 405, "method": "POST", "url": "http://testserver/time-entries/upload", "process_time_ms": "0.77", "response_headers": {"allow": "PUT", "content-length": "31", "content-type": "application/json"}, "error_detail": null, "query_params": {}, "path_params": {"entry_id": "upload"}, "client_host": "testclient", "path": "/time-entries/upload", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:34.353480", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/upload", "status_code": 405}}
--------------------------- Captured stdout teardown ---------------------------
{"timestamp": "2025-02-11T01:56:34.362494", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Shutting down FastAPI server", "context": {}}
---------------------------- Captured log teardown -----------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Shutting down FastAPI server", "timestamp": "2025-02-11T01:56:34.362651", "context": {}}
______________________ test_get_time_entries_with_filters ______________________

client = <starlette.testclient.TestClient object at 0x7f34fb75c8d0>
setup_test_data = {'customers': [<models.customerModel.Customer object at 0x7f34fb70efd0>, <models.customerModel.Customer object at 0x7f...project_id=Unassigned, name=Unassigned)>, <Project(id=2, project_id=Project_Magic_Bullet, name=Project Magic Bullet)>]}

    def test_get_time_entries_with_filters(client, setup_test_data):
        """Test getting time entries with filters"""
        # First create a test entry
        entry_data = {
            "week_number": 41,
            "month": "October",
            "category": "Other",
            "subcategory": "Other Training",
            "customer": "ECOLAB",
            "project": "Project_Magic_Bullet",
            "task_description": "Test task",
            "hours": 8.0,
            "date": "2024-10-07"
        }
        client.post("/time-entries/", json=entry_data)
    
        # Test filtering by customer
        response = client.get("/time-entries/", params={"customer_name": "ECOLAB"})
        assert response.status_code == 200
        data = response.json()
>       assert len(data) > 0
E       assert 0 > 0
E        +  where 0 = len([])

tests/test_routes.py:328: AssertionError
---------------------------- Captured stdout setup -----------------------------
{"timestamp": "2025-02-11T01:56:34.390161", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Starting FastAPI server", "context": {}}
{"timestamp": "2025-02-11T01:56:34.390434", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection on startup", "context": {}}
{"timestamp": "2025-02-11T01:56:34.390708", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection and schema", "context": {}}
{"timestamp": "2025-02-11T01:56:34.449745", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database driver: psycopg2", "context": {}}
{"timestamp": "2025-02-11T01:56:34.450065", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database dialect: postgresql", "context": {}}
{"timestamp": "2025-02-11T01:56:34.450463", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Successfully connected to database", "context": {}}
{"timestamp": "2025-02-11T01:56:34.554858", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Found 5 tables in database", "context": {}}
{"timestamp": "2025-02-11T01:56:34.555267", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expected tables: time_entries, projects, customers, project_managers", "context": {}}
{"timestamp": "2025-02-11T01:56:34.682969", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table customers exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:34.766724", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table projects exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:34.851125", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table project_managers exists with 5 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:34.934949", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table time_entries exists with 12 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:34.935306", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database verification completed successfully", "context": {}}
{"timestamp": "2025-02-11T01:56:34.955289", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "=== CORS Configuration ===", "context": {}}
{"timestamp": "2025-02-11T01:56:34.955568", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Origins: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:34.955794", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "context": {}}
{"timestamp": "2025-02-11T01:56:34.956054", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allow Credentials: False", "context": {}}
{"timestamp": "2025-02-11T01:56:34.956305", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Headers: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:34.956520", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "context": {}}
------------------------------ Captured log setup ------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting FastAPI server", "timestamp": "2025-02-11T01:56:34.390282", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection on startup", "timestamp": "2025-02-11T01:56:34.390566", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection and schema", "timestamp": "2025-02-11T01:56:34.390849", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database driver: psycopg2", "timestamp": "2025-02-11T01:56:34.449856", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database dialect: postgresql", "timestamp": "2025-02-11T01:56:34.450187", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully connected to database", "timestamp": "2025-02-11T01:56:34.450584", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Found 5 tables in database", "timestamp": "2025-02-11T01:56:34.554964", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expected tables: time_entries, projects, customers, project_managers", "timestamp": "2025-02-11T01:56:34.555346", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table customers exists with 9 columns", "timestamp": "2025-02-11T01:56:34.683100", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table projects exists with 9 columns", "timestamp": "2025-02-11T01:56:34.766911", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table project_managers exists with 5 columns", "timestamp": "2025-02-11T01:56:34.851229", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table time_entries exists with 12 columns", "timestamp": "2025-02-11T01:56:34.935062", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database verification completed successfully", "timestamp": "2025-02-11T01:56:34.935383", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "=== CORS Configuration ===", "timestamp": "2025-02-11T01:56:34.955407", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Origins: '*'", "timestamp": "2025-02-11T01:56:34.955647", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "timestamp": "2025-02-11T01:56:34.955895", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allow Credentials: False", "timestamp": "2025-02-11T01:56:34.956162", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Headers: '*'", "timestamp": "2025-02-11T01:56:34.956371", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "timestamp": "2025-02-11T01:56:34.956585", "context": {}}
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:35.346827", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "202", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
{"timestamp": "2025-02-11T01:56:35.347515", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 307", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "0.77", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:35.347949", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
{"timestamp": "2025-02-11T01:56:35.349374", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "202", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
{"timestamp": "2025-02-11T01:56:35.352539", "level": "ERROR", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with exception", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "202", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:35.353103", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
{"timestamp": "2025-02-11T01:56:35.354688", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "url": "http://testserver/time-entries/?customer_name=ECOLAB", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient"}, "path_params": {}, "query_params": {"customer_name": "ECOLAB"}, "request_id": null, "path": "/time-entries/"}}
{"timestamp": "2025-02-11T01:56:35.355341", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 307", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "GET", "url": "http://testserver/time-entries/?customer_name=ECOLAB", "process_time_ms": "0.66", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries?customer_name=ECOLAB"}, "error_detail": null, "query_params": {"customer_name": "ECOLAB"}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:35.355798", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "path": "/time-entries/", "status_code": 307}}
{"timestamp": "2025-02-11T01:56:35.357065", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "url": "http://testserver/time-entries?customer_name=ECOLAB", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient"}, "path_params": {}, "query_params": {"customer_name": "ECOLAB"}, "request_id": null, "path": "/time-entries"}}
{"timestamp": "2025-02-11T01:56:35.358037", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "ProjectRepository initialized", "context": {}}
{"timestamp": "2025-02-11T01:56:35.358335", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "TimeEntryService initialized with database session", "context": {}}
{"timestamp": "2025-02-11T01:56:35.358510", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Retrieving time entries with filters: project_id=None, customer=None", "context": {}}
{"timestamp": "2025-02-11T01:56:35.358786", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Applying pagination: skip=0, limit=100", "context": {}}
{"timestamp": "2025-02-11T01:56:35.361055", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Retrieved 0 time entries", "context": {}}
{"timestamp": "2025-02-11T01:56:35.361911", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request completed successfully", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 200, "process_time_ms": "4.85", "response_headers": {"content-length": "2", "content-type": "application/json"}, "content_type": "application/json", "method": "GET", "path": "/time-entries"}}
{"timestamp": "2025-02-11T01:56:35.362454", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "path": "/time-entries", "status_code": 200}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:35.346941", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "202", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 307", "timestamp": "2025-02-11T01:56:35.347652", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "0.77", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:35.348025", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:35.349469", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "202", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
ERROR    TimesheetTracker:logger.py:29 {"message": "Request failed with exception", "timestamp": "2025-02-11T01:56:35.352762", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "202", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:35.353218", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:35.354800", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "url": "http://testserver/time-entries/?customer_name=ECOLAB", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient"}, "path_params": {}, "query_params": {"customer_name": "ECOLAB"}, "request_id": null, "path": "/time-entries/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 307", "timestamp": "2025-02-11T01:56:35.355494", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "GET", "url": "http://testserver/time-entries/?customer_name=ECOLAB", "process_time_ms": "0.66", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries?customer_name=ECOLAB"}, "error_detail": null, "query_params": {"customer_name": "ECOLAB"}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:35.355926", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "path": "/time-entries/", "status_code": 307}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:35.357256", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "url": "http://testserver/time-entries?customer_name=ECOLAB", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient"}, "path_params": {}, "query_params": {"customer_name": "ECOLAB"}, "request_id": null, "path": "/time-entries"}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "ProjectRepository initialized", "timestamp": "2025-02-11T01:56:35.358212", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "TimeEntryService initialized with database session", "timestamp": "2025-02-11T01:56:35.358387", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Retrieving time entries with filters: project_id=None, customer=None", "timestamp": "2025-02-11T01:56:35.358557", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Applying pagination: skip=0, limit=100", "timestamp": "2025-02-11T01:56:35.358843", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Retrieved 0 time entries", "timestamp": "2025-02-11T01:56:35.361167", "context": {}}
INFO     TimesheetTracker:logger.py:29 {"message": "Request completed successfully", "timestamp": "2025-02-11T01:56:35.362124", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 200, "process_time_ms": "4.85", "response_headers": {"content-length": "2", "content-type": "application/json"}, "content_type": "application/json", "method": "GET", "path": "/time-entries"}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:35.362570", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "path": "/time-entries", "status_code": 200}}
--------------------------- Captured stdout teardown ---------------------------
{"timestamp": "2025-02-11T01:56:35.370688", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Shutting down FastAPI server", "context": {}}
---------------------------- Captured log teardown -----------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Shutting down FastAPI server", "timestamp": "2025-02-11T01:56:35.370807", "context": {}}
_______________________ test_get_time_entries_pagination _______________________

client = <starlette.testclient.TestClient object at 0x7f34fb584650>
setup_test_data = {'customers': [<models.customerModel.Customer object at 0x7f34fb654a50>, <models.customerModel.Customer object at 0x7f...project_id=Unassigned, name=Unassigned)>, <Project(id=2, project_id=Project_Magic_Bullet, name=Project Magic Bullet)>]}

    def test_get_time_entries_pagination(client, setup_test_data):
        """Test time entries pagination"""
        # Create multiple test entries
        entry_data = {
            "week_number": 41,
            "month": "October",
            "category": "Other",
            "subcategory": "Other Training",
            "customer": "ECOLAB",
            "project": "Project_Magic_Bullet",
            "task_description": "Test task",
            "hours": 8.0,
            "date": "2024-10-07"
        }
    
        for i in range(5):
            entry_data["task_description"] = f"Task {i}"
            client.post("/time-entries/", json=entry_data)
    
        # Test first page
        response = client.get("/time-entries/", params={"skip": 0, "limit": 2})
        assert response.status_code == 200
        data = response.json()
>       assert len(data) == 2
E       assert 0 == 2
E        +  where 0 = len([])

tests/test_routes.py:361: AssertionError
---------------------------- Captured stdout setup -----------------------------
{"timestamp": "2025-02-11T01:56:35.399664", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Starting FastAPI server", "context": {}}
{"timestamp": "2025-02-11T01:56:35.400073", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection on startup", "context": {}}
{"timestamp": "2025-02-11T01:56:35.400408", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Verifying database connection and schema", "context": {}}
{"timestamp": "2025-02-11T01:56:35.463020", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database driver: psycopg2", "context": {}}
{"timestamp": "2025-02-11T01:56:35.463525", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database dialect: postgresql", "context": {}}
{"timestamp": "2025-02-11T01:56:35.463780", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Successfully connected to database", "context": {}}
{"timestamp": "2025-02-11T01:56:35.604536", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Found 5 tables in database", "context": {}}
{"timestamp": "2025-02-11T01:56:35.604940", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expected tables: time_entries, projects, customers, project_managers", "context": {}}
{"timestamp": "2025-02-11T01:56:35.751707", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table customers exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:35.848592", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table projects exists with 9 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:35.943266", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table project_managers exists with 5 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:36.023346", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Table time_entries exists with 12 columns", "context": {}}
{"timestamp": "2025-02-11T01:56:36.023679", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Database verification completed successfully", "context": {}}
{"timestamp": "2025-02-11T01:56:36.044854", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "=== CORS Configuration ===", "context": {}}
{"timestamp": "2025-02-11T01:56:36.045234", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Origins: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:36.045539", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "context": {}}
{"timestamp": "2025-02-11T01:56:36.045863", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allow Credentials: False", "context": {}}
{"timestamp": "2025-02-11T01:56:36.046155", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Allowed Headers: '*'", "context": {}}
{"timestamp": "2025-02-11T01:56:36.046459", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "context": {}}
------------------------------ Captured log setup ------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Starting FastAPI server", "timestamp": "2025-02-11T01:56:35.399805", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection on startup", "timestamp": "2025-02-11T01:56:35.400197", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Verifying database connection and schema", "timestamp": "2025-02-11T01:56:35.400501", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database driver: psycopg2", "timestamp": "2025-02-11T01:56:35.463270", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database dialect: postgresql", "timestamp": "2025-02-11T01:56:35.463605", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully connected to database", "timestamp": "2025-02-11T01:56:35.463858", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Found 5 tables in database", "timestamp": "2025-02-11T01:56:35.604667", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expected tables: time_entries, projects, customers, project_managers", "timestamp": "2025-02-11T01:56:35.605507", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table customers exists with 9 columns", "timestamp": "2025-02-11T01:56:35.751841", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table projects exists with 9 columns", "timestamp": "2025-02-11T01:56:35.848722", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table project_managers exists with 5 columns", "timestamp": "2025-02-11T01:56:35.943416", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Table time_entries exists with 12 columns", "timestamp": "2025-02-11T01:56:36.023467", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Database verification completed successfully", "timestamp": "2025-02-11T01:56:36.023756", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "=== CORS Configuration ===", "timestamp": "2025-02-11T01:56:36.044986", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Origins: '*'", "timestamp": "2025-02-11T01:56:36.045360", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Methods: 'GET, POST, PUT, DELETE, OPTIONS, PATCH'", "timestamp": "2025-02-11T01:56:36.045640", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allow Credentials: False", "timestamp": "2025-02-11T01:56:36.045963", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Allowed Headers: '*'", "timestamp": "2025-02-11T01:56:36.046215", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Expose Headers: 'X-Total-Count, X-Correlation-ID'", "timestamp": "2025-02-11T01:56:36.046548", "context": {}}
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T01:56:36.086449", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
{"timestamp": "2025-02-11T01:56:36.087414", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 307", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "0.99", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:36.087891", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
{"timestamp": "2025-02-11T01:56:36.089928", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
{"timestamp": "2025-02-11T01:56:36.093815", "level": "ERROR", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with exception", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:36.094428", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
{"timestamp": "2025-02-11T01:56:36.096026", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
{"timestamp": "2025-02-11T01:56:36.096696", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 307", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "0.68", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:36.097466", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
{"timestamp": "2025-02-11T01:56:36.098812", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
{"timestamp": "2025-02-11T01:56:36.102543", "level": "ERROR", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with exception", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:36.103129", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
{"timestamp": "2025-02-11T01:56:36.104662", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
{"timestamp": "2025-02-11T01:56:36.105464", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 307", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "0.85", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:36.105836", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
{"timestamp": "2025-02-11T01:56:36.106937", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
{"timestamp": "2025-02-11T01:56:36.109971", "level": "ERROR", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with exception", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:36.110631", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
{"timestamp": "2025-02-11T01:56:36.112241", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
{"timestamp": "2025-02-11T01:56:36.113817", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 307", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "0.72", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:36.114302", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
{"timestamp": "2025-02-11T01:56:36.115573", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
{"timestamp": "2025-02-11T01:56:36.118460", "level": "ERROR", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with exception", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:36.119035", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
{"timestamp": "2025-02-11T01:56:36.120512", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
{"timestamp": "2025-02-11T01:56:36.121054", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 307", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "0.60", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:36.121570", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
{"timestamp": "2025-02-11T01:56:36.122895", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
{"timestamp": "2025-02-11T01:56:36.125823", "level": "ERROR", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with exception", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:36.126513", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
{"timestamp": "2025-02-11T01:56:36.127949", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "url": "http://testserver/time-entries/?skip=0&limit=2", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient"}, "path_params": {}, "query_params": {"skip": "0", "limit": "2"}, "request_id": null, "path": "/time-entries/"}}
{"timestamp": "2025-02-11T01:56:36.128668", "level": "WARNING", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request failed with status 307", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "GET", "url": "http://testserver/time-entries/?skip=0&limit=2", "process_time_ms": "0.65", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries?skip=0&limit=2"}, "error_detail": null, "query_params": {"skip": "0", "limit": "2"}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
{"timestamp": "2025-02-11T01:56:36.129229", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "path": "/time-entries/", "status_code": 307}}
{"timestamp": "2025-02-11T01:56:36.130607", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Incoming request", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "url": "http://testserver/time-entries?skip=0&limit=2", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient"}, "path_params": {}, "query_params": {"skip": "0", "limit": "2"}, "request_id": null, "path": "/time-entries"}}
{"timestamp": "2025-02-11T01:56:36.131590", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "ProjectRepository initialized", "context": {}}
{"timestamp": "2025-02-11T01:56:36.131982", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "TimeEntryService initialized with database session", "context": {}}
{"timestamp": "2025-02-11T01:56:36.132334", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Retrieving time entries with filters: project_id=None, customer=None", "context": {}}
{"timestamp": "2025-02-11T01:56:36.132651", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Applying pagination: skip=0, limit=2", "context": {}}
{"timestamp": "2025-02-11T01:56:36.133474", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Retrieved 0 time entries", "context": {}}
{"timestamp": "2025-02-11T01:56:36.134314", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Request completed successfully", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 200, "process_time_ms": "3.69", "response_headers": {"content-length": "2", "content-type": "application/json"}, "content_type": "application/json", "method": "GET", "path": "/time-entries"}}
{"timestamp": "2025-02-11T01:56:36.134836", "level": "DEBUG", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Adding CORS headers to response", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "path": "/time-entries", "status_code": 200}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:36.086624", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 307", "timestamp": "2025-02-11T01:56:36.087529", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "0.99", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:36.087972", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:36.090034", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
ERROR    TimesheetTracker:logger.py:29 {"message": "Request failed with exception", "timestamp": "2025-02-11T01:56:36.094126", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:36.094526", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:36.096184", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 307", "timestamp": "2025-02-11T01:56:36.096877", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "0.68", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:36.097547", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:36.098999", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
ERROR    TimesheetTracker:logger.py:29 {"message": "Request failed with exception", "timestamp": "2025-02-11T01:56:36.102818", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:36.103239", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:36.104995", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 307", "timestamp": "2025-02-11T01:56:36.105587", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "0.85", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:36.105907", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:36.107049", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
ERROR    TimesheetTracker:logger.py:29 {"message": "Request failed with exception", "timestamp": "2025-02-11T01:56:36.110322", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:36.110835", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:36.112385", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 307", "timestamp": "2025-02-11T01:56:36.113925", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "0.72", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:36.114412", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:36.115714", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
ERROR    TimesheetTracker:logger.py:29 {"message": "Request failed with exception", "timestamp": "2025-02-11T01:56:36.118733", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:36.119220", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:36.120635", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries/", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 307", "timestamp": "2025-02-11T01:56:36.121257", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "POST", "url": "http://testserver/time-entries/", "process_time_ms": "0.60", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries"}, "error_detail": null, "query_params": {}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:36.121679", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries/", "status_code": 307}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:36.123041", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "url": "http://testserver/time-entries", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "path_params": {}, "query_params": {}, "request_id": null, "path": "/time-entries"}}
ERROR    TimesheetTracker:logger.py:29 {"message": "Request failed with exception", "timestamp": "2025-02-11T01:56:36.126183", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "error_type": "AttributeError", "error_message": "'TimesheetService' object has no attribute 'create_entry'", "traceback": "Traceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 111, in receive\n    return self.receive_nowait()\n           ^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 106, in receive_nowait\n    raise WouldBlock\nanyio.WouldBlock\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 124, in receive\n    return receiver.item\n           ^^^^^^^^^^^^^\nAttributeError: 'MemoryObjectItemReceiver' object has no attribute 'item'\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 157, in call_next\n    message = await recv_stream.receive()\n              ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/streams/memory.py\", line 126, in receive\n    raise EndOfStream\nanyio.EndOfStream\n\nDuring handling of the above exception, another exception occurred:\n\nTraceback (most recent call last):\n  File \"/home/runner/workspace/utils/middleware.py\", line 45, in logging_middleware\n    response = await call_next(request)\n               ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 163, in call_next\n    raise app_exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/base.py\", line 149, in coro\n    await self.app(scope, receive_or_disconnect, send_no_error)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/cors.py\", line 85, in __call__\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/middleware/exceptions.py\", line 62, in __call__\n    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 715, in __call__\n    await self.middleware_stack(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 735, in app\n    await route.handle(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 288, in handle\n    await self.app(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 76, in app\n    await wrap_app_handling_exceptions(app, request)(scope, receive, send)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 53, in wrapped_app\n    raise exc\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/_exception_handler.py\", line 42, in wrapped_app\n    await app(scope, receive, sender)\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/routing.py\", line 73, in app\n    response = await f(request)\n               ^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 301, in app\n    raw_response = await run_endpoint_function(\n                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/fastapi/routing.py\", line 214, in run_endpoint_function\n    return await run_in_threadpool(dependant.call, **values)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/starlette/concurrency.py\", line 39, in run_in_threadpool\n    return await anyio.to_thread.run_sync(func, *args)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/to_thread.py\", line 56, in run_sync\n    return await get_async_backend().run_sync_in_worker_thread(\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 2505, in run_sync_in_worker_thread\n    return await future\n           ^^^^^^^^^^^^\n  File \"/home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/anyio/_backends/_asyncio.py\", line 1005, in run\n    result = context.run(func, *args)\n             ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/home/runner/workspace/main.py\", line 161, in create_time_entry\n    return service.create_entry(entry)\n           ^^^^^^^^^^^^^^^^^^^^\nAttributeError: 'TimesheetService' object has no attribute 'create_entry'\n", "request_method": "POST", "request_url": "http://testserver/time-entries", "request_headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient", "content-length": "199", "content-type": "application/json"}, "client_host": "testclient", "query_params": {}, "path_params": {}, "path": "/time-entries", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:36.126630", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "POST", "path": "/time-entries", "status_code": 500}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:36.128098", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "url": "http://testserver/time-entries/?skip=0&limit=2", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient"}, "path_params": {}, "query_params": {"skip": "0", "limit": "2"}, "request_id": null, "path": "/time-entries/"}}
WARNING  TimesheetTracker:logger.py:29 {"message": "Request failed with status 307", "timestamp": "2025-02-11T01:56:36.128843", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 307, "method": "GET", "url": "http://testserver/time-entries/?skip=0&limit=2", "process_time_ms": "0.65", "response_headers": {"content-length": "0", "location": "http://testserver/time-entries?skip=0&limit=2"}, "error_detail": null, "query_params": {"skip": "0", "limit": "2"}, "path_params": {}, "client_host": "testclient", "path": "/time-entries/", "origin": null, "cors_method": null, "cors_headers": null}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:36.129350", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "path": "/time-entries/", "status_code": 307}}
INFO     TimesheetTracker:logger.py:29 {"message": "Incoming request", "timestamp": "2025-02-11T01:56:36.130765", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "url": "http://testserver/time-entries?skip=0&limit=2", "client_host": "testclient", "headers": {"host": "testserver", "accept": "*/*", "accept-encoding": "gzip, deflate", "connection": "keep-alive", "user-agent": "testclient"}, "path_params": {}, "query_params": {"skip": "0", "limit": "2"}, "request_id": null, "path": "/time-entries"}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "ProjectRepository initialized", "timestamp": "2025-02-11T01:56:36.131809", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "TimeEntryService initialized with database session", "timestamp": "2025-02-11T01:56:36.132060", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Retrieving time entries with filters: project_id=None, customer=None", "timestamp": "2025-02-11T01:56:36.132419", "context": {}}
DEBUG    TimesheetTracker:logger.py:32 {"message": "Applying pagination: skip=0, limit=2", "timestamp": "2025-02-11T01:56:36.132723", "context": {}}
INFO     TimesheetTracker:logger.py:32 {"message": "Retrieved 0 time entries", "timestamp": "2025-02-11T01:56:36.133545", "context": {}}
INFO     TimesheetTracker:logger.py:29 {"message": "Request completed successfully", "timestamp": "2025-02-11T01:56:36.134411", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "status_code": 200, "process_time_ms": "3.69", "response_headers": {"content-length": "2", "content-type": "application/json"}, "content_type": "application/json", "method": "GET", "path": "/time-entries"}}
DEBUG    TimesheetTracker:logger.py:29 {"message": "Adding CORS headers to response", "timestamp": "2025-02-11T01:56:36.134952", "context": {"correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "method": "GET", "path": "/time-entries", "status_code": 200}}
--------------------------- Captured stdout teardown ---------------------------
{"timestamp": "2025-02-11T01:56:36.143219", "level": "INFO", "correlation_id": "5ca67278-e745-4e95-bb3e-f5c17147b858", "logger": "TimesheetTracker", "message": "Shutting down FastAPI server", "context": {}}
---------------------------- Captured log teardown -----------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Shutting down FastAPI server", "timestamp": "2025-02-11T01:56:36.143302", "context": {}}
=============================== warnings summary ===============================
.pythonlibs/lib/python3.11/site-packages/pydantic/_internal/_config.py:345
  /home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/pydantic/_internal/_config.py:345: UserWarning: Valid config keys have changed in V2:
  * 'orm_mode' has been renamed to 'from_attributes'
    warnings.warn(message, UserWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/test_csv_validation.py::test_parse_csv_with_valid_data - assert 0 == 2
 +  where 0 = len([])
FAILED tests/test_csv_validation.py::test_clean_string_value - TypeError: clean_string_value() got an unexpected keyword argument 'field_type'
FAILED tests/test_csv_validation.py::test_parse_csv_with_empty_rows - assert 0 == 2
 +  where 0 = len([])
FAILED tests/test_csv_validation.py::test_parse_csv_with_special_characters - assert 0 == 1
 +  where 0 = len([])
FAILED tests/test_csv_validation.py::test_parse_csv_with_missing_values - assert 0 == 1
 +  where 0 = len([])
FAILED tests/test_csv_validation.py::test_parse_csv_with_invalid_customer_project_mapping - assert 0 == 2
 +  where 0 = len([])
FAILED tests/test_interfaces.py::test_project_interface - assert 500 == 200
 +  where 500 = <Response [500 Internal Server Error]>.status_code
FAILED tests/test_models.py::test_model_timestamps - assert datetime.datetime(2025, 2, 11, 1, 56, 27) > datetime.datetime(2025, 2, 11, 1, 56, 27)
 +  where datetime.datetime(2025, 2, 11, 1, 56, 27) = <models.customerModel.Customer object at 0x7f34fcfb5f90>.updated_at
 +  and   datetime.datetime(2025, 2, 11, 1, 56, 27) = <models.customerModel.Customer object at 0x7f34fcfb5f90>.created_at
FAILED tests/test_repositories.py::test_customer_repository_get_by_id - AttributeError: 'CustomerRepository' object has no attribute 'get_by_id'
FAILED tests/test_repositories.py::test_customer_repository_update - AttributeError: 'CustomerRepository' object has no attribute 'get_by_id'
FAILED tests/test_repositories.py::test_customer_repository_delete - AttributeError: 'CustomerRepository' object has no attribute 'get_by_id'
FAILED tests/test_routes.py::test_root_endpoint - assert 404 == 200
 +  where 404 = <Response [404 Not Found]>.status_code
FAILED tests/test_routes.py::test_create_time_entry - assert 500 == 201
 +  where 500 = <Response [500 Internal Server Error]>.status_code
FAILED tests/test_routes.py::test_get_time_entries_with_database_query - assert 500 == 201
 +  where 500 = <Response [500 Internal Server Error]>.status_code
FAILED tests/test_routes.py::test_get_time_entries_complex_filtering - assert 500 == 201
 +  where 500 = <Response [500 Internal Server Error]>.status_code
FAILED tests/test_routes.py::test_upload_csv_valid - assert 405 == 201
 +  where 405 = <Response [405 Method Not Allowed]>.status_code
FAILED tests/test_routes.py::test_upload_csv_invalid_format - TypeError: Multipart file uploads require 'io.BytesIO', not 'io.StringIO'.
FAILED tests/test_routes.py::test_upload_csv_with_validation_errors - assert 405 == 201
 +  where 405 = <Response [405 Method Not Allowed]>.status_code
FAILED tests/test_routes.py::test_upload_csv_with_foreign_key_violation - assert 405 == 201
 +  where 405 = <Response [405 Method Not Allowed]>.status_code
FAILED tests/test_routes.py::test_upload_csv_with_mismatched_customer_project - assert 405 == 201
 +  where 405 = <Response [405 Method Not Allowed]>.status_code
FAILED tests/test_routes.py::test_upload_csv_with_multiple_validation_errors - assert 405 == 201
 +  where 405 = <Response [405 Method Not Allowed]>.status_code
FAILED tests/test_routes.py::test_get_time_entries_with_filters - assert 0 > 0
 +  where 0 = len([])
FAILED tests/test_routes.py::test_get_time_entries_pagination - assert 0 == 2
 +  where 0 = len([])
======================== 23 failed, 1 warning in 9.87s =========================
