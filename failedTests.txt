============================= test session starts ==============================
platform linux -- Python 3.11.10, pytest-8.3.4, pluggy-1.5.0 -- /home/runner/workspace/.pythonlibs/bin/python
cachedir: .pytest_cache
rootdir: /home/runner/workspace
configfile: pyproject.toml
plugins: anyio-4.7.0, asyncio-0.25.2, cov-6.0.0
asyncio: mode=Mode.STRICT, asyncio_default_fixture_loop_scope=None
collecting ... collected 8 items / 6 deselected / 2 selected
run-last-failure: rerun previous 2 failures (skipped 10 files)

tests/test_file_upload.py::test_xls_analyzer_invalid_data FAILED         [ 50%]
tests/test_file_upload.py::test_xls_analyzer_missing_columns FAILED      [100%]

=================================== FAILURES ===================================
________________________ test_xls_analyzer_invalid_data ________________________

tmp_path = PosixPath('/tmp/pytest-of-runner/pytest-22/test_xls_analyzer_invalid_data0')
invalid_timesheet_data = {'Category': ['Development'], 'Date': ['2024-10-07'], 'Hours': [8.0]}
setup_test_data = {'customers': [<models.customerModel.Customer object at 0x7f86ae77c190>, <models.customerModel.Customer object at 0x7f...project_id=Unassigned, name=Unassigned)>, <Project(id=2, project_id=Project_Magic_Bullet, name=Project Magic Bullet)>]}

    def test_xls_analyzer_invalid_data(tmp_path, invalid_timesheet_data, setup_test_data):
        """Test XLSAnalyzer with invalid data"""
        excel_file = create_test_excel(tmp_path, invalid_timesheet_data)
    
        with open(excel_file, "rb") as f:
            contents = f.read()
            analyzer = XLSAnalyzer()
            records = analyzer.read_excel(contents)
    
            assert len(records) == 1
>           assert records[0]['Customer'] in ['-', 'Unassigned']
E           AssertionError: assert None in ['-', 'Unassigned']

tests/test_file_upload.py:74: AssertionError
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T20:14:24.483294", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Successfully parsed 1 records from Excel file", "context": {}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully parsed 1 records from Excel file", "timestamp": "2025-02-11T20:14:24.483442", "context": {}}
______________________ test_xls_analyzer_missing_columns _______________________

tmp_path = PosixPath('/tmp/pytest-of-runner/pytest-22/test_xls_analyzer_missing_colu0')

    def test_xls_analyzer_missing_columns(tmp_path):
        """Test XLSAnalyzer with missing required columns"""
        data = {'Category': ['Test'], 'Hours': [8.0]}
        excel_file = create_test_excel(tmp_path, data)
    
        with open(excel_file, "rb") as f:
            contents = f.read()
            analyzer = XLSAnalyzer()
            records = analyzer.read_excel(contents)
    
            assert len(records) == 1
>           assert records[0]['Customer'] == '-'
E           AssertionError: assert None == '-'

tests/test_file_upload.py:144: AssertionError
----------------------------- Captured stdout call -----------------------------
{"timestamp": "2025-02-11T20:14:24.587837", "level": "INFO", "correlation_id": "undefined", "logger": "TimesheetTracker", "message": "Successfully parsed 1 records from Excel file", "context": {}}
------------------------------ Captured log call -------------------------------
INFO     TimesheetTracker:logger.py:32 {"message": "Successfully parsed 1 records from Excel file", "timestamp": "2025-02-11T20:14:24.587978", "context": {}}
=============================== warnings summary ===============================
.pythonlibs/lib/python3.11/site-packages/pydantic/_internal/_config.py:345
  /home/runner/workspace/.pythonlibs/lib/python3.11/site-packages/pydantic/_internal/_config.py:345: UserWarning: Valid config keys have changed in V2:
  * 'orm_mode' has been renamed to 'from_attributes'
    warnings.warn(message, UserWarning)

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
=========================== short test summary info ============================
FAILED tests/test_file_upload.py::test_xls_analyzer_invalid_data - AssertionE...
FAILED tests/test_file_upload.py::test_xls_analyzer_missing_columns - Asserti...
================== 2 failed, 6 deselected, 1 warning in 0.61s ==================
